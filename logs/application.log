2022-09-06 10:07:49.977  INFO 12872 --- [restartedMain] c.l.m.p.ProductServiceApplication        : Starting ProductServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 12872 (D:\Work\event-driven-ms\product-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 10:07:49.987 DEBUG 12872 --- [restartedMain] c.l.m.p.ProductServiceApplication        : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 10:07:49.989  INFO 12872 --- [restartedMain] c.l.m.p.ProductServiceApplication        : The following 1 profile is active: "dev"
2022-09-06 10:08:01.346  INFO 12872 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 10:08:01.347  INFO 12872 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 10:08:01.899  INFO 12872 --- [restartedMain] o.a.c.c.C.[.[localhost].[/product]       : Initializing Spring embedded WebApplicationContext
2022-09-06 10:08:03.733  INFO 12872 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 10:08:04.350  INFO 12872 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 10:08:05.112  INFO 12872 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 10:08:05.531  INFO 12872 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 10:08:07.238  INFO 12872 --- [restartedMain] liquibase.changelog                      : Creating database history table with name: public.databasechangelog
2022-09-06 10:08:07.296  INFO 12872 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 10:08:07.795  INFO 12872 --- [restartedMain] liquibase.changelog                      : SQL in file ../sql/structure/create_product_table.sql executed
2022-09-06 10:08:07.796  INFO 12872 --- [restartedMain] liquibase.changelog                      : ChangeSet db/changelog/structure.xml::1::liem ran successfully in 153ms
2022-09-06 10:08:08.087  INFO 12872 --- [restartedMain] liquibase.changelog                      : SQL in file ../sql/structure/create_product_lookup_table.sql executed
2022-09-06 10:08:08.089  INFO 12872 --- [restartedMain] liquibase.changelog                      : ChangeSet db/changelog/structure.xml::2::liem ran successfully in 249ms
2022-09-06 10:08:08.173  INFO 12872 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 10:08:08.588  INFO 12872 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 10:08:08.753  INFO 12872 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 10:08:09.238  INFO 12872 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 10:08:09.667  INFO 12872 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 10:08:10.833  INFO 23664 --- [restartedMain] c.l.m.u.UserServiceApplication           : Starting UserServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 23664 (D:\Work\event-driven-ms\user-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 10:08:10.836 DEBUG 23664 --- [restartedMain] c.l.m.u.UserServiceApplication           : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 10:08:10.838  INFO 23664 --- [restartedMain] c.l.m.u.UserServiceApplication           : The following 1 profile is active: "dev"
2022-09-06 10:08:11.434  INFO 12872 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 10:08:11.516 TRACE 12872 --- [restartedMain] c.l.m.p.c.config.HandlerConfiguration    : Handler registration: com.liem.ms.productservice.command.handler.impl.ProductEventErrorHandler@3e6c07f0
2022-09-06 10:08:12.415  INFO 12872 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:08:12.417  INFO 12872 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:08:12.420  INFO 12872 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:08:12.421  INFO 12872 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:08:13.439 TRACE 12872 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.CreateProductCommandInterceptor@543b3fc3
2022-09-06 10:08:13.456 TRACE 12872 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.UpdateProductCommandInterceptor@65ed1192
2022-09-06 10:08:13.470 TRACE 12872 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.DeleteProductCommandInterceptor@237e6a5d
2022-09-06 10:08:13.485 TRACE 12872 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.ReserveProductCommandInterceptor@5773633c
2022-09-06 10:08:18.020  INFO 23664 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 10:08:18.022  INFO 23664 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 10:08:18.415  INFO 23664 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/user]   : Initializing Spring embedded WebApplicationContext
2022-09-06 10:08:20.318  INFO 23664 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 10:08:20.669  INFO 23664 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 10:08:20.927  INFO 23664 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 10:08:21.208  INFO 23664 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 10:08:21.337  INFO 13216 --- [restartedMain] c.l.m.p.PaymentServiceApplication        : Starting PaymentServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 13216 (D:\Work\event-driven-ms\payment-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 10:08:21.339 DEBUG 13216 --- [restartedMain] c.l.m.p.PaymentServiceApplication        : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 10:08:21.340  INFO 13216 --- [restartedMain] c.l.m.p.PaymentServiceApplication        : The following 1 profile is active: "dev"
2022-09-06 10:08:21.549  INFO 23664 --- [restartedMain] liquibase.changelog                      : Creating database history table with name: public.databasechangelog
2022-09-06 10:08:21.574  INFO 23664 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 10:08:21.669  INFO 23664 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 10:08:21.823  INFO 23664 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 10:08:21.915  INFO 23664 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 10:08:22.104  INFO 23664 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 10:08:22.255  INFO 23664 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 10:08:22.895  INFO 12872 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 10:08:23.507  INFO 23664 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 10:08:23.971  INFO 23664 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:08:23.973  INFO 23664 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:08:23.974  INFO 23664 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:08:23.976  INFO 23664 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:08:24.257  INFO 12872 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 10:08:24.284  INFO 12872 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 10:08:24.323  INFO 12872 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : QueryChannel for context 'default' connected, 0 registrations resubscribed
2022-09-06 10:08:24.337  INFO 12872 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : Registered handler for query 'com.liem.ms.productservice.query.queries.FindProductQuery : java.util.List<com.liem.ms.productservice.query.entity.ProductEntity>' in context 'default'
2022-09-06 10:08:24.437  INFO 12872 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 10:08:24.440  INFO 12872 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.product.CreateProductCommand' in context 'default'
2022-09-06 10:08:24.448  INFO 12872 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.ReserveProductCommand' in context 'default'
2022-09-06 10:08:24.449  INFO 12872 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.product.SupplyProductCommand' in context 'default'
2022-09-06 10:08:24.450  INFO 12872 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.CancelProductReserveCommand' in context 'default'
2022-09-06 10:08:24.452  INFO 12872 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.product.UpdateProductCommand' in context 'default'
2022-09-06 10:08:24.454  INFO 12872 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.common.DeleteCommand' in context 'default'
2022-09-06 10:08:24.585  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 10:08:24.594  INFO 12872 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:08:24.657  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 10:08:24.658  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 10:08:24.658  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 10:08:24.659  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 10:08:24.659  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 10:08:24.660  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 10:08:24.660  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 10:08:25.325  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 10:08:25.329  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 10:08:25.334  INFO 12872 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 10:08:25.345  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662433705342 with initial instances count: 0
2022-09-06 10:08:25.360  INFO 12872 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662433705360, current=UP, previous=STARTING]
2022-09-06 10:08:25.364  INFO 12872 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:957780e952bbcf8f54d46e93cc0362d9: registering service...
2022-09-06 10:08:25.722  INFO 12872 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:957780e952bbcf8f54d46e93cc0362d9 - registration status: 204
2022-09-06 10:08:25.870  INFO 12872 --- [restartedMain] c.l.m.p.ProductServiceApplication        : Started ProductServiceApplication in 38.291 seconds (JVM running for 42.947)
2022-09-06 10:08:25.926  INFO 13216 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 10:08:25.926  INFO 13216 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 10:08:26.118  INFO 13216 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring embedded WebApplicationContext
2022-09-06 10:08:26.574  INFO 12872 --- [RMI TCP Connection(21)-172.27.30.1] o.a.c.c.C.[.[localhost].[/product]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 10:08:27.323  INFO 13216 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 10:08:27.635  INFO 13216 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 10:08:27.974  INFO 13216 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 10:08:28.210  INFO 13216 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 10:08:28.998  INFO 13216 --- [restartedMain] liquibase.changelog                      : Creating database history table with name: public.databasechangelog
2022-09-06 10:08:29.019  INFO 13216 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 10:08:29.141  INFO 13216 --- [restartedMain] liquibase.changelog                      : SQL in file ../sql/structure/create_payment_table.sql executed
2022-09-06 10:08:29.141  INFO 13216 --- [restartedMain] liquibase.changelog                      : ChangeSet db/changelog/structure.xml::1::liem ran successfully in 28ms
2022-09-06 10:08:29.161  INFO 13216 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 10:08:29.359  INFO 13216 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 10:08:29.426  INFO 13216 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 10:08:29.656  INFO 13216 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 10:08:29.809  INFO 13216 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 10:08:30.181  INFO 23664 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 10:08:30.957  INFO 13216 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 10:08:31.112  INFO 23664 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 10:08:31.132  INFO 23664 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 10:08:31.165  INFO 23664 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : QueryChannel for context 'default' connected, 0 registrations resubscribed
2022-09-06 10:08:31.182  INFO 23664 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : Registered handler for query 'com.liem.ms.coreservice.queries.FetchUserPaymentDetailsQuery : com.liem.ms.coreservice.models.User' in context 'default'
2022-09-06 10:08:31.262  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 10:08:31.267  INFO 23664 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:08:31.299  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 10:08:31.300  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 10:08:31.300  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 10:08:31.300  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 10:08:31.300  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 10:08:31.300  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 10:08:31.301  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 10:08:31.734  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 10:08:31.740  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 10:08:31.744  INFO 23664 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 10:08:31.754  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662433711752 with initial instances count: 1
2022-09-06 10:08:31.762  INFO 23664 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662433711762, current=UP, previous=STARTING]
2022-09-06 10:08:31.765  INFO 23664 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_USER-SERVICE/user-service:994e8eee017a630cab5b3345534f1756: registering service...
2022-09-06 10:08:31.828  INFO 23664 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_USER-SERVICE/user-service:994e8eee017a630cab5b3345534f1756 - registration status: 204
2022-09-06 10:08:32.150  INFO 23664 --- [restartedMain] c.l.m.u.UserServiceApplication           : Started UserServiceApplication in 23.166 seconds (JVM running for 26.724)
2022-09-06 10:08:32.448  INFO 23664 --- [RMI TCP Connection(11)-172.27.30.1] o.a.c.c.C.[Tomcat].[localhost].[/user]   : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 10:08:33.316  INFO 13216 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:08:33.317  INFO 13216 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:08:33.319  INFO 13216 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:08:33.320  INFO 13216 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:08:36.689  INFO 13216 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 10:08:37.476  INFO 13216 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 10:08:37.492  INFO 13216 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 10:08:37.508  INFO 13216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 10:08:37.511  INFO 13216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.CancelPaymentCommand' in context 'default'
2022-09-06 10:08:37.520  INFO 13216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.ProcessPaymentCommand' in context 'default'
2022-09-06 10:08:37.758  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 10:08:37.766  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.paymentservice.query.handler, segment=Segment[0/0]}
2022-09-06 10:08:37.769  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 10:08:37.776  INFO 13216 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:08:37.779  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] o.a.e.TrackingEventProcessor             : Fetched token: null for segment: Segment[0/0]
2022-09-06 10:08:37.816  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 10:08:37.817  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 10:08:37.817  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 10:08:37.817  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 10:08:37.817  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 10:08:37.818  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 10:08:37.818  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 10:08:38.050  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] c.l.m.p.q.handler.PaymentEventsHandler   : PaymentProcessedEvent is called for orderId: 41903a98-79e7-415b-8813-46e8dd10a971
2022-09-06 10:08:38.121  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] c.l.m.p.q.handler.PaymentEventsHandler   : PaymentProcessedEvent is called for orderId: 364ba309-b250-4bf2-b3fe-243022b0c2b5
2022-09-06 10:08:38.155  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] c.l.m.p.q.handler.PaymentEventsHandler   : PaymentProcessedEvent is called for orderId: 868ede5a-6ec6-4efd-aaf6-ab4e4fb59e27
2022-09-06 10:08:38.356  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 10:08:38.362  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 10:08:38.365  INFO 13216 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 10:08:38.371  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662433718370 with initial instances count: 1
2022-09-06 10:08:38.380  INFO 13216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662433718380, current=UP, previous=STARTING]
2022-09-06 10:08:38.382  INFO 13216 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PAYMENT-SERVICE/payment-service:75b82d8c3dca1f89d2612a5952b25fdc: registering service...
2022-09-06 10:08:38.434  INFO 13216 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PAYMENT-SERVICE/payment-service:75b82d8c3dca1f89d2612a5952b25fdc - registration status: 204
2022-09-06 10:08:38.803  INFO 13216 --- [restartedMain] c.l.m.p.PaymentServiceApplication        : Started PaymentServiceApplication in 19.053 seconds (JVM running for 22.387)
2022-09-06 10:08:39.284  INFO 13216 --- [RMI TCP Connection(9)-172.27.30.1] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 10:08:55.329  INFO 12872 --- [DiscoveryClient-CacheRefreshExecutor-0] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 10:08:55.330  INFO 12872 --- [DiscoveryClient-CacheRefreshExecutor-0] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 10:08:55.330  INFO 12872 --- [DiscoveryClient-CacheRefreshExecutor-0] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 10:08:55.330  INFO 12872 --- [DiscoveryClient-CacheRefreshExecutor-0] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 10:08:55.330  INFO 12872 --- [DiscoveryClient-CacheRefreshExecutor-0] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 10:08:55.330  INFO 12872 --- [DiscoveryClient-CacheRefreshExecutor-0] com.netflix.discovery.DiscoveryClient    : Application version is -1: false
2022-09-06 10:08:55.331  INFO 12872 --- [DiscoveryClient-CacheRefreshExecutor-0] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 10:08:55.345  INFO 12872 --- [DiscoveryClient-CacheRefreshExecutor-0] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 10:13:24.664  INFO 12872 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:13:31.303  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:13:37.821  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:13:50.699  INFO 12892 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Starting OrderServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 12892 (D:\Work\event-driven-ms\order-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 10:13:50.701 DEBUG 12892 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 10:13:50.701  INFO 12892 --- [restartedMain] c.l.m.o.OrderServiceApplication          : The following 1 profile is active: "dev"
2022-09-06 10:13:54.826  INFO 12892 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 10:13:54.826  INFO 12892 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 10:13:55.001  INFO 12892 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring embedded WebApplicationContext
2022-09-06 10:13:55.687  INFO 12892 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 10:13:55.884  INFO 12892 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 10:13:56.097  INFO 12892 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 10:13:56.227  INFO 12892 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 10:13:56.874  INFO 12892 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 10:13:56.999  INFO 12892 --- [restartedMain] liquibase.changelog                      : SQL in file ../sql/structure/create_order_table.sql executed
2022-09-06 10:13:57.000  INFO 12892 --- [restartedMain] liquibase.changelog                      : ChangeSet db/changelog/structure.xml::1::liem ran successfully in 39ms
2022-09-06 10:13:57.032  INFO 12892 --- [restartedMain] liquibase.changelog                      : SQL in file ../sql/structure/create_order_lookup_table.sql executed
2022-09-06 10:13:57.033  INFO 12892 --- [restartedMain] liquibase.changelog                      : ChangeSet db/changelog/structure.xml::2::liem ran successfully in 22ms
2022-09-06 10:13:57.044  INFO 12892 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 10:13:57.184  INFO 12892 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 10:13:57.241  INFO 12892 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 10:13:57.406  INFO 12892 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 10:13:57.544  INFO 12892 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 10:13:58.432  INFO 12892 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 10:13:59.224  INFO 12892 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:13:59.226  INFO 12892 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:13:59.227  INFO 12892 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:13:59.228  INFO 12892 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:14:03.790  INFO 12892 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 10:14:04.622  INFO 12892 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 10:14:04.639  INFO 12892 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 10:14:04.654  INFO 12892 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 10:14:04.657  INFO 12892 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 10:14:04.666  INFO 12892 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 10:14:04.667  INFO 12892 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 10:14:04.821  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 10:14:04.821  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 10:14:04.828  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.saga.handler.impl, segment=Segment[0/0]}
2022-09-06 10:14:04.828  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.command.handler, segment=Segment[0/0]}
2022-09-06 10:14:04.843  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Fetched token: null for segment: Segment[0/0]
2022-09-06 10:14:04.844  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Fetched token: null for segment: Segment[0/0]
2022-09-06 10:14:04.852  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 10:14:04.857  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderSagaImplProcessor, segment=Segment[0/0]}
2022-09-06 10:14:04.893  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=41} for segment: Segment[0/0]
2022-09-06 10:14:05.012  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 10:14:05.020  INFO 12892 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:14:05.037 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=a72917d9-3325-46c6-9356-179f1fb85e17, productId=203a43bb-a8fe-45eb-a128-0d937491e301, userId=user_001, quantity=3, addressId=203a43bb-a8fe-45eb-a128-0d937491e301, orderStatus=CREATED)
2022-09-06 10:14:05.097  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 10:14:05.098  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 10:14:05.099  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 10:14:05.099  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 10:14:05.100  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 10:14:05.100  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 10:14:05.080  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=a72917d9-3325-46c6-9356-179f1fb85e17, productId=null, userId=null, quantity=3)
2022-09-06 10:14:05.100  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 10:14:05.165 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=118698a1-103c-4f5e-a3b9-f017d5b1639b, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.166  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=118698a1-103c-4f5e-a3b9-f017d5b1639b, productId=null, userId=null, quantity=3)
2022-09-06 10:14:05.183 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=659913a1-84a9-4195-9043-c2ec71c91d08, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.183  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=659913a1-84a9-4195-9043-c2ec71c91d08, productId=null, userId=null, quantity=3)
2022-09-06 10:14:05.204 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=203b9f3d-7aea-4be2-b5b8-72411f31a592, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.204  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=203b9f3d-7aea-4be2-b5b8-72411f31a592, productId=null, userId=null, quantity=3)
2022-09-06 10:14:05.221 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=d3cf1ed3-c284-4f79-9b6e-ca69face6970, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.222  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=d3cf1ed3-c284-4f79-9b6e-ca69face6970, productId=null, userId=null, quantity=3)
2022-09-06 10:14:05.239 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=006a8dbc-efe6-4b18-968f-d9d9fb019dd8, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.240  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=006a8dbc-efe6-4b18-968f-d9d9fb019dd8, productId=null, userId=null, quantity=1)
2022-09-06 10:14:05.261 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=41903a98-79e7-415b-8813-46e8dd10a971, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.261  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=41903a98-79e7-415b-8813-46e8dd10a971, productId=null, userId=null, quantity=1)
2022-09-06 10:14:05.280 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=364ba309-b250-4bf2-b3fe-243022b0c2b5, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.280  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=364ba309-b250-4bf2-b3fe-243022b0c2b5, productId=null, userId=null, quantity=1)
2022-09-06 10:14:05.304 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=10c008e1-f18d-424a-8ecd-55ec7cdc9c3c, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.304  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=10c008e1-f18d-424a-8ecd-55ec7cdc9c3c, productId=null, userId=null, quantity=1)
2022-09-06 10:14:05.324 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=a4497945-9071-43d1-b725-afb8bb530181, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.325  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=a4497945-9071-43d1-b725-afb8bb530181, productId=null, userId=null, quantity=1)
2022-09-06 10:14:05.345 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=ad4eea59-3f56-4094-aabf-ff613c76c712, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.346  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=ad4eea59-3f56-4094-aabf-ff613c76c712, productId=null, userId=null, quantity=1)
2022-09-06 10:14:05.368 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=360878dc-8d39-4c61-9970-1ce021fc202e, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.369  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=360878dc-8d39-4c61-9970-1ce021fc202e, productId=null, userId=null, quantity=1)
2022-09-06 10:14:05.401 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=4eb0b42c-c4c5-40f0-bce7-7fd3fb2044ea, productId=8390a283-bf44-4490-9954-ca2f2f6df8de, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.401  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=4eb0b42c-c4c5-40f0-bce7-7fd3fb2044ea, productId=null, userId=null, quantity=1)
2022-09-06 10:14:05.421 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=868ede5a-6ec6-4efd-aaf6-ab4e4fb59e27, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:14:05.421  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=868ede5a-6ec6-4efd-aaf6-ab4e4fb59e27, productId=null, userId=null, quantity=1)
2022-09-06 10:14:05.567  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 10:14:05.572  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 10:14:05.577  INFO 12892 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 10:14:05.583  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662434045582 with initial instances count: 3
2022-09-06 10:14:05.593  INFO 12892 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662434045593, current=UP, previous=STARTING]
2022-09-06 10:14:05.597  INFO 12892 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:1cded45fd0c02690274b56af8d1be355: registering service...
2022-09-06 10:14:05.658  INFO 12892 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:1cded45fd0c02690274b56af8d1be355 - registration status: 204
2022-09-06 10:14:05.994  INFO 12892 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Started OrderServiceApplication in 16.4 seconds (JVM running for 18.106)
2022-09-06 10:14:06.363  INFO 12892 --- [RMI TCP Connection(8)-172.27.30.1] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 10:18:24.666  INFO 12872 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:18:29.571  INFO 12872 --- [http-nio-8080-exec-1] c.l.m.p.q.s.i.ProductQueryServiceImpl    : Send query to find product
2022-09-06 10:18:29.819  INFO 12872 --- [QueryProcessor-0] c.l.m.p.q.h.i.ProductQueryHandlerImpl    : Found products: 0
2022-09-06 10:18:31.306  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:18:37.823  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:19:05.104  INFO 12892 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:19:29.308  INFO 12872 --- [http-nio-8080-exec-2] c.l.m.p.c.s.i.ProductCommandServiceImpl  : Send create product command: ProductDto(price=10.5, quantity=100)
2022-09-06 10:19:29.311 TRACE 12872 --- [http-nio-8080-exec-2] .m.p.c.i.CreateProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='2765d7f8-77c8-4a09-b53b-2d888c3e8b66', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 10:19:29.312  INFO 12872 --- [http-nio-8080-exec-2] .m.p.c.i.CreateProductCommandInterceptor : Create product command interceptor handle
2022-09-06 10:19:29.347  INFO 12872 --- [http-nio-8080-exec-2] .m.p.c.i.CreateProductCommandInterceptor : Product creation is valid
2022-09-06 10:19:29.349 TRACE 12872 --- [http-nio-8080-exec-2] .m.p.c.i.UpdateProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='2765d7f8-77c8-4a09-b53b-2d888c3e8b66', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 10:19:29.350  INFO 12872 --- [http-nio-8080-exec-2] .m.p.c.i.UpdateProductCommandInterceptor : Pass to next dispatch interceptor
2022-09-06 10:19:29.350 TRACE 12872 --- [http-nio-8080-exec-2] .m.p.c.i.DeleteProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='2765d7f8-77c8-4a09-b53b-2d888c3e8b66', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 10:19:29.350  INFO 12872 --- [http-nio-8080-exec-2] .m.p.c.i.DeleteProductCommandInterceptor : Pass to next dispatch interceptor
2022-09-06 10:19:29.351 TRACE 12872 --- [http-nio-8080-exec-2] m.p.c.i.ReserveProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='2765d7f8-77c8-4a09-b53b-2d888c3e8b66', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 10:19:29.351  INFO 12872 --- [http-nio-8080-exec-2] m.p.c.i.ReserveProductCommandInterceptor : Pass to next dispatch interceptor
2022-09-06 10:19:29.412 TRACE 12872 --- [CommandProcessor-0] c.l.m.p.core.domain.ProductAggregate     : Create product command handle: CreateProductCommand(price=10.5, quantity=100)
2022-09-06 10:19:29.420 TRACE 12872 --- [CommandProcessor-0] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 10:19:29.462 TRACE 12872 --- [CommandProcessor-0] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 10:19:29.463  INFO 12872 --- [CommandProcessor-0] .m.p.c.h.i.ProductLookupEventHandlerImpl : Save look up entity: ProductLookupEntity(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, productName=Product_001, productQuantity=100)
2022-09-06 10:19:29.526 TRACE 12872 --- [CommandProcessor-0] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 10:19:29.526  INFO 12872 --- [CommandProcessor-0] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Create entity: ProductEntity(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, name=Product_001, description=Product_001, updatedAt=2022-09-06T03:19:29.526196200Z, createdAt=2022-09-06T03:19:29.526196200Z, version=1, isActive=true, price=10.5, quantity=100)
2022-09-06 10:19:33.995  INFO 12872 --- [http-nio-8080-exec-3] c.l.m.p.q.s.i.ProductQueryServiceImpl    : Send query to find product
2022-09-06 10:19:34.022  INFO 12872 --- [QueryProcessor-3] c.l.m.p.q.h.i.ProductQueryHandlerImpl    : Found products: 1
2022-09-06 10:20:23.267  INFO 12872 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662434423267, current=DOWN, previous=UP]
2022-09-06 10:20:23.268  INFO 12872 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:957780e952bbcf8f54d46e93cc0362d9: registering service...
2022-09-06 10:20:23.276  INFO 12872 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:957780e952bbcf8f54d46e93cc0362d9 - registration status: 204
2022-09-06 10:20:23.535  INFO 12872 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.productservice.command.commands.product.CreateProductCommand' in context 'default'
2022-09-06 10:20:23.536  INFO 12872 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.coreservice.commands.ReserveProductCommand' in context 'default'
2022-09-06 10:20:23.536  INFO 12872 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.productservice.command.commands.product.SupplyProductCommand' in context 'default'
2022-09-06 10:20:23.537  INFO 12872 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.coreservice.commands.CancelProductReserveCommand' in context 'default'
2022-09-06 10:20:23.538  INFO 12872 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.productservice.command.commands.product.UpdateProductCommand' in context 'default'
2022-09-06 10:20:23.539  INFO 12872 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.productservice.command.commands.common.DeleteCommand' in context 'default'
2022-09-06 10:20:23.686  INFO 12872 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-09-06 10:20:23.693  INFO 12872 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-09-06 10:20:23.695  INFO 12872 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2022-09-06 10:20:26.698  WARN 12872 --- [DiscoveryClient-1] c.netflix.discovery.TimedSupervisorTask  : task supervisor shutting down, can't accept the task
2022-09-06 10:20:26.699  INFO 12872 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2022-09-06 10:20:26.706  INFO 12872 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:957780e952bbcf8f54d46e93cc0362d9 - deregister  status: 200
2022-09-06 10:20:26.715  INFO 12872 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
2022-09-06 10:20:35.934  INFO 25484 --- [restartedMain] c.l.m.p.ProductServiceApplication        : Starting ProductServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 25484 (D:\Work\event-driven-ms\product-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 10:20:35.935 DEBUG 25484 --- [restartedMain] c.l.m.p.ProductServiceApplication        : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 10:20:35.936  INFO 25484 --- [restartedMain] c.l.m.p.ProductServiceApplication        : The following 1 profile is active: "dev"
2022-09-06 10:20:39.437  INFO 25484 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 10:20:39.438  INFO 25484 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 10:20:39.631  INFO 25484 --- [restartedMain] o.a.c.c.C.[.[localhost].[/product]       : Initializing Spring embedded WebApplicationContext
2022-09-06 10:20:40.394  INFO 25484 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 10:20:40.577  INFO 25484 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 10:20:40.769  INFO 25484 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 10:20:40.900  INFO 25484 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 10:20:41.506  INFO 25484 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 10:20:41.588  INFO 25484 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 10:20:41.715  INFO 25484 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 10:20:41.770  INFO 25484 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 10:20:41.918  INFO 25484 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 10:20:42.048  INFO 25484 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 10:20:42.827  INFO 25484 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 10:20:42.857 TRACE 25484 --- [restartedMain] c.l.m.p.c.config.HandlerConfiguration    : Handler registration: com.liem.ms.productservice.command.handler.impl.ProductEventErrorHandler@2adf8b82
2022-09-06 10:20:43.301  INFO 25484 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:20:43.303  INFO 25484 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:20:43.304  INFO 25484 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:20:43.305  INFO 25484 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:20:43.355 TRACE 25484 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.DeleteProductCommandInterceptor@277204d0
2022-09-06 10:20:43.813 TRACE 25484 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.ReserveProductCommandInterceptor@877b0c5
2022-09-06 10:20:43.818 TRACE 25484 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.UpdateProductCommandInterceptor@68d9b2a3
2022-09-06 10:20:43.823 TRACE 25484 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.CreateProductCommandInterceptor@7d3b252
2022-09-06 10:20:48.173  INFO 25484 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 10:20:48.944  INFO 25484 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 10:20:48.961  INFO 25484 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 10:20:48.991  INFO 25484 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : QueryChannel for context 'default' connected, 0 registrations resubscribed
2022-09-06 10:20:49.002  INFO 25484 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : Registered handler for query 'com.liem.ms.productservice.query.queries.FindProductQuery : java.util.List<com.liem.ms.productservice.query.entity.ProductEntity>' in context 'default'
2022-09-06 10:20:49.088  INFO 25484 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 10:20:49.090  INFO 25484 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.product.CreateProductCommand' in context 'default'
2022-09-06 10:20:49.097  INFO 25484 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.ReserveProductCommand' in context 'default'
2022-09-06 10:20:49.098  INFO 25484 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.product.SupplyProductCommand' in context 'default'
2022-09-06 10:20:49.099  INFO 25484 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.CancelProductReserveCommand' in context 'default'
2022-09-06 10:20:49.100  INFO 25484 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.product.UpdateProductCommand' in context 'default'
2022-09-06 10:20:49.101  INFO 25484 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.common.DeleteCommand' in context 'default'
2022-09-06 10:20:49.174  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 10:20:49.179  INFO 25484 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:20:49.212  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 10:20:49.212  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 10:20:49.212  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 10:20:49.212  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 10:20:49.213  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 10:20:49.213  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 10:20:49.213  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 10:20:49.626  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 10:20:49.630  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 10:20:49.633  INFO 25484 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 10:20:49.639  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662434449638 with initial instances count: 3
2022-09-06 10:20:49.647  INFO 25484 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662434449647, current=UP, previous=STARTING]
2022-09-06 10:20:49.650  INFO 25484 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:18cf38e1522b5203709882db18e4c6b0: registering service...
2022-09-06 10:20:49.701  INFO 25484 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:18cf38e1522b5203709882db18e4c6b0 - registration status: 204
2022-09-06 10:20:50.028  INFO 25484 --- [restartedMain] c.l.m.p.ProductServiceApplication        : Started ProductServiceApplication in 15.248 seconds (JVM running for 17.49)
2022-09-06 10:20:50.800  INFO 25484 --- [RMI TCP Connection(4)-172.27.30.1] o.a.c.c.C.[.[localhost].[/product]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 10:22:47.440  INFO 25484 --- [http-nio-8080-exec-1] c.l.m.p.q.s.i.ProductQueryServiceImpl    : Send query to find product
2022-09-06 10:22:47.676  INFO 25484 --- [QueryProcessor-0] c.l.m.p.q.h.i.ProductQueryHandlerImpl    : Found products: 1
2022-09-06 10:23:31.309  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:23:37.825  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:24:05.108  INFO 12892 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:24:34.637  INFO 12892 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Send create order command: OrderDto(id=null, userId=user_001, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, addressId=address_001, rejectReason=null)
2022-09-06 10:24:34.697 TRACE 12892 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Create order command handle: CreateOrderCommand(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:24:34.706 TRACE 12892 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:24:34.752 TRACE 12892 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderCreatedEvent(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:24:34.753  INFO 12892 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Create order: OrderEntity(id=9dd1321f-008f-4910-b34d-7a78e42bb762, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, userId=user_001, quantity=3, addressId=address_001, rejectReason=null, orderStatus=CREATED)
2022-09-06 10:24:34.800 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:24:34.801  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=9dd1321f-008f-4910-b34d-7a78e42bb762, productId=null, userId=null, quantity=3)
2022-09-06 10:24:34.825  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Start transaction : handle after created order: OrderCreatedEvent(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:24:35.052 TRACE 25484 --- [CommandProcessor-0] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 10:24:35.055 TRACE 25484 --- [CommandProcessor-0] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=1, orderId=868ede5a-6ec6-4efd-aaf6-ab4e4fb59e27, userId=user_001)
2022-09-06 10:24:35.073 TRACE 25484 --- [CommandProcessor-0] c.l.m.p.core.domain.ProductAggregate     : Reserve product command handle: ReserveProductCommand(productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001)
2022-09-06 10:24:35.085 TRACE 25484 --- [CommandProcessor-0] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001)
2022-09-06 10:24:35.104 TRACE 25484 --- [CommandProcessor-0] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductReservedEvent(id=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001)
2022-09-06 10:24:35.133 ERROR 25484 --- [CommandProcessor-0] .m.p.c.h.i.ProductLookupEventHandlerImpl : Lookup entity with product id '008f5f81-0e6e-48ff-b7ac-ff874405aedc' not found
2022-09-06 10:24:35.136 TRACE 25484 --- [CommandProcessor-0] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductReservedEvent(id=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001)
2022-09-06 10:24:35.150 ERROR 25484 --- [CommandProcessor-0] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc
2022-09-06 10:24:35.150 ERROR 25484 --- [CommandProcessor-0] c.l.m.p.c.h.i.ProductEventErrorHandler   : Product event error handle Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc with message GenericDomainEventMessage{payload={ProductReservedEvent(id=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001)}, metadata={'traceId'->'68966261-0477-466c-af57-2977c6969e90', 'correlationId'->'bc89498d-b707-4421-9d9f-06dc189fdf05'}, messageIdentifier='92637e98-ae15-459f-b7c2-47ae84462d6f', timestamp='2022-09-06T03:24:35.084843500Z', aggregateType='ProductAggregate', aggregateIdentifier='008f5f81-0e6e-48ff-b7ac-ff874405aedc', sequenceNumber=2} by org.axonframework.eventhandling.AnnotationEventHandlerAdapter@133f6d73
2022-09-06 10:24:35.180 TRACE 12892 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command message: GenericCommandMessage{payload={ReserveProductCommand(productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001)}, metadata={'traceId'->'68966261-0477-466c-af57-2977c6969e90', 'correlationId'->'cc7bef01-0603-42dc-baa2-3af2dd85998f'}, messageIdentifier='bc89498d-b707-4421-9d9f-06dc189fdf05', commandName='com.liem.ms.coreservice.commands.ReserveProductCommand'}
2022-09-06 10:24:35.186 TRACE 12892 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={}, messageIdentifier='91ff2961-0ed8-4342-a3bf-111c0668bc8e', exception='org.axonframework.commandhandling.CommandExecutionException: Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc'}
2022-09-06 10:24:35.187 ERROR 12892 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Reserved product failed: Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc
2022-09-06 10:24:35.221 TRACE 25484 --- [CommandProcessor-1] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 10:24:35.222 TRACE 25484 --- [CommandProcessor-1] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=1, orderId=868ede5a-6ec6-4efd-aaf6-ab4e4fb59e27, userId=user_001)
2022-09-06 10:24:35.222 TRACE 25484 --- [CommandProcessor-1] c.l.m.p.core.domain.ProductAggregate     : Cancel product reserve command handle: CancelProductReserveCommand(productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001, reason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc)
2022-09-06 10:24:35.241 TRACE 25484 --- [CommandProcessor-1] c.l.m.p.core.domain.ProductAggregate     : Product cancel reserve event sourcing handle: ProductCancelReserveEvent(productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001, reason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc)
2022-09-06 10:24:35.248 TRACE 25484 --- [CommandProcessor-1] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductCancelReserveEvent(productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001, reason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc)
2022-09-06 10:24:35.252 ERROR 25484 --- [CommandProcessor-1] .m.p.c.h.i.ProductLookupEventHandlerImpl : Lookup entity with product id '008f5f81-0e6e-48ff-b7ac-ff874405aedc' not found
2022-09-06 10:24:35.266 ERROR 12892 --- [grpc-default-executor-3] .s.i.CancelProductReservationServiceImpl : Cancel product '008f5f81-0e6e-48ff-b7ac-ff874405aedc' reservation failed
2022-09-06 10:24:35.286  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after cancel product reservation process: ProductCancelReserveEvent(productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, quantity=3, orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, userId=user_001, reason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc)
2022-09-06 10:24:35.339 TRACE 12892 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:24:35.342 TRACE 12892 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Reject order command handle: RejectOrderCommand(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, reason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc)
2022-09-06 10:24:35.343 TRACE 12892 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order reject event sourcing handle: OrderRejectedEvent(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, orderStatus=REJECTED, reason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc)
2022-09-06 10:24:35.350 TRACE 12892 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderRejectedEvent(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, orderStatus=REJECTED, reason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc)
2022-09-06 10:24:35.357  INFO 12892 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Reject order: OrderEntity(id=9dd1321f-008f-4910-b34d-7a78e42bb762, productId=008f5f81-0e6e-48ff-b7ac-ff874405aedc, userId=user_001, quantity=3, addressId=address_001, rejectReason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc, orderStatus=REJECTED)
2022-09-06 10:24:35.372 TRACE 12892 --- [grpc-default-executor-3] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Command message: GenericCommandMessage{payload={RejectOrderCommand(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, reason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc)}, metadata={'traceId'->'5ced0292-942a-43da-b3c5-dd437caecd15', 'correlationId'->'5a38588c-dcdb-4256-a673-82a95b620c67'}, messageIdentifier='6836df20-6b3b-41e5-949d-6e58010f0cbe', commandName='com.liem.ms.orderservice.command.commands.RejectOrderCommand'}
2022-09-06 10:24:35.373 TRACE 12892 --- [grpc-default-executor-3] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'5ced0292-942a-43da-b3c5-dd437caecd15', 'correlationId'->'6836df20-6b3b-41e5-949d-6e58010f0cbe'}, messageIdentifier='8ad3c7c8-761f-486d-922e-d5ecb5d66e53', exception='null'}
2022-09-06 10:24:35.373  INFO 12892 --- [grpc-default-executor-3] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Reject order completed
2022-09-06 10:24:35.383  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Complete transaction : handle after reject order: OrderRejectedEvent(orderId=9dd1321f-008f-4910-b34d-7a78e42bb762, orderStatus=REJECTED, reason=Product is not found by id: 008f5f81-0e6e-48ff-b7ac-ff874405aedc)
2022-09-06 10:25:49.217  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:28:31.311  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:28:37.828  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:29:05.111  INFO 12892 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:30:49.220  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:31:07.741  INFO 12892 --- [http-nio-8081-exec-3] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Send create order command: OrderDto(id=null, userId=user_001, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, addressId=address_001, rejectReason=null)
2022-09-06 10:31:07.752 TRACE 12892 --- [CommandProcessor-2] c.l.m.o.core.domain.OrderAggregate       : Create order command handle: CreateOrderCommand(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:31:07.753 TRACE 12892 --- [CommandProcessor-2] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:31:07.756 TRACE 12892 --- [CommandProcessor-2] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderCreatedEvent(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:31:07.757  INFO 12892 --- [CommandProcessor-2] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Create order: OrderEntity(id=8bdd8f5b-7370-4c89-b542-606adaf062ab, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, rejectReason=null, orderStatus=CREATED)
2022-09-06 10:31:07.776 TRACE 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:31:07.776  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=8bdd8f5b-7370-4c89-b542-606adaf062ab, productId=null, userId=null, quantity=3)
2022-09-06 10:31:07.781  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Start transaction : handle after created order: OrderCreatedEvent(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:31:07.817 TRACE 25484 --- [CommandProcessor-2] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 10:31:07.818 TRACE 25484 --- [CommandProcessor-2] c.l.m.p.core.domain.ProductAggregate     : Reserve product command handle: ReserveProductCommand(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001)
2022-09-06 10:31:07.818 TRACE 25484 --- [CommandProcessor-2] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001)
2022-09-06 10:31:07.821 TRACE 25484 --- [CommandProcessor-2] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001)
2022-09-06 10:31:07.825  INFO 25484 --- [CommandProcessor-2] .m.p.c.h.i.ProductLookupEventHandlerImpl : Reserve look up entity: ProductLookupEntity(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, productName=Product_001, productQuantity=97)
2022-09-06 10:31:07.843 TRACE 25484 --- [CommandProcessor-2] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001)
2022-09-06 10:31:07.854  INFO 25484 --- [CommandProcessor-2] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Reserve product quantity: ProductEntity(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, name=Product_001, description=Product_001, updatedAt=2022-09-06T10:31:07.854574800, createdAt=2022-09-06T03:19:29.526196200Z, version=2, isActive=true, price=10.5, quantity=97)
2022-09-06 10:31:07.907  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after reserve product: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001)
2022-09-06 10:31:07.921  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send user payment details query: FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 10:31:07.932 TRACE 12892 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command message: GenericCommandMessage{payload={ReserveProductCommand(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001)}, metadata={'traceId'->'7e987233-b3eb-46da-bc3d-6de36ab2005b', 'correlationId'->'749bebd5-2571-448c-974e-20f51c0f48b7'}, messageIdentifier='40324e1e-c572-4500-8b8d-8d5615aad215', commandName='com.liem.ms.coreservice.commands.ReserveProductCommand'}
2022-09-06 10:31:07.933 TRACE 12892 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'7e987233-b3eb-46da-bc3d-6de36ab2005b', 'correlationId'->'40324e1e-c572-4500-8b8d-8d5615aad215'}, messageIdentifier='d40ea54f-dda5-4e7d-b409-77caebb24c25', exception='null'}
2022-09-06 10:31:07.934  INFO 12892 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Reserved product '21801d8e-b57c-4fea-8437-3d7ec34a9c26' with reserved quantity 3 items
2022-09-06 10:31:08.127  INFO 23664 --- [QueryProcessor-0] c.l.m.u.query.handler.UserEventsHandler  : Find user payment detail query handle; FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 10:31:08.196  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : User payment details query: User(firstName=Liem, lastName=Doan, userId=user_001, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123))
2022-09-06 10:31:08.207  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Schedule deadline for 'payment-process-deadline' by id '6ddbd3e7-62a7-49af-ad22-c98efc48fd1c'
2022-09-06 10:31:08.216  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send payment process command: ProcessPaymentCommand(paymentId=4196691b-4228-4c65-9e4b-df9aee4e5e25, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=6ddbd3e7-62a7-49af-ad22-c98efc48fd1c)
2022-09-06 10:31:08.246  INFO 13216 --- [CommandProcessor-0] c.l.m.p.core.PaymentAggregate            : Process payment command handle: ProcessPaymentCommand(paymentId=4196691b-4228-4c65-9e4b-df9aee4e5e25, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=6ddbd3e7-62a7-49af-ad22-c98efc48fd1c)
2022-09-06 10:31:08.278  INFO 13216 --- [CommandProcessor-0] c.l.m.p.core.PaymentAggregate            : Payment processed event sourcing handle: PaymentProcessedEvent(paymentId=4196691b-4228-4c65-9e4b-df9aee4e5e25, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, paymentDetails=null, scheduleId=6ddbd3e7-62a7-49af-ad22-c98efc48fd1c)
2022-09-06 10:31:08.317  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] c.l.m.p.q.handler.PaymentEventsHandler   : PaymentProcessedEvent is called for orderId: 8bdd8f5b-7370-4c89-b542-606adaf062ab
2022-09-06 10:31:08.317  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Payment process '4196691b-4228-4c65-9e4b-df9aee4e5e25' completed
2022-09-06 10:31:08.374  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after payment process: PaymentProcessedEvent(paymentId=4196691b-4228-4c65-9e4b-df9aee4e5e25, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, paymentDetails=null, scheduleId=6ddbd3e7-62a7-49af-ad22-c98efc48fd1c)
2022-09-06 10:31:08.376  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Send approve order command: ApproveOrderCommand(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab)
2022-09-06 10:31:08.377  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Cancel deadline for 'payment-process-deadline' by id '6ddbd3e7-62a7-49af-ad22-c98efc48fd1c'
2022-09-06 10:31:08.405 TRACE 12892 --- [CommandProcessor-3] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:31:08.407 TRACE 12892 --- [CommandProcessor-3] c.l.m.o.core.domain.OrderAggregate       : Approve order command handle: ApproveOrderCommand(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab)
2022-09-06 10:31:08.407 TRACE 12892 --- [CommandProcessor-3] c.l.m.o.core.domain.OrderAggregate       : Order approve event sourcing handle: OrderApprovedEvent(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, orderStatus=APPROVED)
2022-09-06 10:31:08.409 TRACE 12892 --- [CommandProcessor-3] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderApprovedEvent(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, orderStatus=APPROVED)
2022-09-06 10:31:08.413  INFO 12892 --- [CommandProcessor-3] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Approve order: OrderEntity(id=8bdd8f5b-7370-4c89-b542-606adaf062ab, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, rejectReason=null, orderStatus=APPROVED)
2022-09-06 10:31:08.434 TRACE 12892 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command message: GenericCommandMessage{payload={ApproveOrderCommand(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab)}, metadata={'traceId'->'7e987233-b3eb-46da-bc3d-6de36ab2005b', 'correlationId'->'ce6d076a-6a73-4e40-966c-73d7baa17641'}, messageIdentifier='c02a6ba2-d561-4d39-9d64-76d48218b85c', commandName='com.liem.ms.orderservice.command.commands.ApproveOrderCommand'}
2022-09-06 10:31:08.435 TRACE 12892 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'7e987233-b3eb-46da-bc3d-6de36ab2005b', 'correlationId'->'c02a6ba2-d561-4d39-9d64-76d48218b85c'}, messageIdentifier='736d628d-3ea9-45ac-967e-4b812a2d2b77', exception='null'}
2022-09-06 10:31:08.435  INFO 12892 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Approve order '8bdd8f5b-7370-4c89-b542-606adaf062ab' completed
2022-09-06 10:31:08.452  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Complete transaction : handle after approved order 'OrderApprovedEvent(orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, orderStatus=APPROVED)'
2022-09-06 10:33:31.312  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:33:37.830  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:34:05.112  INFO 12892 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:34:49.613  INFO 12892 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662435289613, current=DOWN, previous=UP]
2022-09-06 10:34:49.613  INFO 12892 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:1cded45fd0c02690274b56af8d1be355: registering service...
2022-09-06 10:34:49.622  INFO 12892 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:1cded45fd0c02690274b56af8d1be355 - registration status: 204
2022-09-06 10:34:49.830  INFO 12892 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderSagaImplProcessor'.
2022-09-06 10:34:49.830  INFO 12892 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderSagaImplProcessor' awaiting termination...
2022-09-06 10:34:49.835  INFO 12892 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.command.handler'.
2022-09-06 10:34:49.836  INFO 12892 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.command.handler' awaiting termination...
2022-09-06 10:34:49.836  INFO 12892 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.saga.handler.impl'.
2022-09-06 10:34:49.836  INFO 12892 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.saga.handler.impl' awaiting termination...
2022-09-06 10:34:50.029  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 10:34:50.030  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 10:34:50.386  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 10:34:50.386  INFO 12892 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 10:34:50.822  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 10:34:50.823  INFO 12892 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 10:34:50.832  INFO 12892 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 10:34:50.839  INFO 12892 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 10:34:50.841  INFO 12892 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 10:34:50.977  INFO 12892 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-09-06 10:34:50.984  INFO 12892 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-09-06 10:34:50.987  INFO 12892 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2022-09-06 10:34:53.989  INFO 12892 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2022-09-06 10:34:53.998  INFO 12892 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:1cded45fd0c02690274b56af8d1be355 - deregister  status: 200
2022-09-06 10:34:54.004  INFO 12892 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
2022-09-06 10:35:04.225  INFO 14760 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Starting OrderServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 14760 (D:\Work\event-driven-ms\order-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 10:35:04.226 DEBUG 14760 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 10:35:04.228  INFO 14760 --- [restartedMain] c.l.m.o.OrderServiceApplication          : The following 1 profile is active: "dev"
2022-09-06 10:35:08.240  INFO 14760 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 10:35:08.241  INFO 14760 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 10:35:08.425  INFO 14760 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring embedded WebApplicationContext
2022-09-06 10:35:09.264  INFO 14760 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 10:35:09.505  INFO 14760 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 10:35:09.719  INFO 14760 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 10:35:09.888  INFO 14760 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 10:35:10.553  INFO 14760 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 10:35:10.636  INFO 14760 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 10:35:10.775  INFO 14760 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 10:35:10.836  INFO 14760 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 10:35:11.017  INFO 14760 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 10:35:11.169  INFO 14760 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 10:35:12.187  INFO 14760 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 10:35:13.042  INFO 14760 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:35:13.045  INFO 14760 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 10:35:13.046  INFO 14760 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:35:13.048  INFO 14760 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 10:35:18.539  INFO 14760 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 10:35:19.475  INFO 14760 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 10:35:19.499  INFO 14760 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 10:35:19.519  INFO 14760 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 10:35:19.521  INFO 14760 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 10:35:19.532  INFO 14760 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 10:35:19.532  INFO 14760 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 10:35:19.722  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 10:35:19.723  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 10:35:19.724  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 10:35:19.731  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderSagaImplProcessor, segment=Segment[0/0]}
2022-09-06 10:35:19.731  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.saga.handler.impl, segment=Segment[0/0]}
2022-09-06 10:35:19.731  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.command.handler, segment=Segment[0/0]}
2022-09-06 10:35:19.755  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=41} for segment: Segment[0/0]
2022-09-06 10:35:19.757  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=46} for segment: Segment[0/0]
2022-09-06 10:35:19.759  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=49} for segment: Segment[0/0]
2022-09-06 10:35:19.769  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 10:35:19.773  INFO 14760 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:35:19.837  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 10:35:19.838  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 10:35:19.838  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 10:35:19.838  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 10:35:19.839  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 10:35:19.839  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 10:35:19.839  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 10:35:20.282  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 10:35:20.286  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 10:35:20.290  INFO 14760 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 10:35:20.297  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662435320296 with initial instances count: 3
2022-09-06 10:35:20.305  INFO 14760 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662435320305, current=UP, previous=STARTING]
2022-09-06 10:35:20.308  INFO 14760 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:f0c510bb67d8bc9ed42d75c69f46b9b6: registering service...
2022-09-06 10:35:20.364  INFO 14760 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:f0c510bb67d8bc9ed42d75c69f46b9b6 - registration status: 204
2022-09-06 10:35:20.690  INFO 14760 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Started OrderServiceApplication in 17.681 seconds (JVM running for 20.632)
2022-09-06 10:35:21.474  INFO 14760 --- [RMI TCP Connection(4)-172.27.30.1] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 10:35:49.221  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:37:57.517  INFO 14760 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Send create order command: OrderDto(id=null, userId=user_001, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, addressId=address_001, rejectReason=null)
2022-09-06 10:37:57.577 TRACE 14760 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Create order command handle: CreateOrderCommand(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, userId=user_001, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:37:57.586 TRACE 14760 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:37:57.614 TRACE 14760 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderCreatedEvent(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:37:57.614  INFO 14760 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Create order: OrderEntity(id=eccfa866-6d8c-49d6-bb8e-e45423795204, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, rejectReason=null, orderStatus=CREATED)
2022-09-06 10:37:57.696 TRACE 14760 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:37:57.696  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=eccfa866-6d8c-49d6-bb8e-e45423795204, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3)
2022-09-06 10:37:57.721  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Start transaction : handle after created order: OrderCreatedEvent(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:37:57.776 TRACE 25484 --- [CommandProcessor-3] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 10:37:57.777 TRACE 25484 --- [CommandProcessor-3] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001)
2022-09-06 10:37:57.778 TRACE 25484 --- [CommandProcessor-3] c.l.m.p.core.domain.ProductAggregate     : Reserve product command handle: ReserveProductCommand(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, userId=user_001)
2022-09-06 10:37:57.778 TRACE 25484 --- [CommandProcessor-3] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, userId=user_001)
2022-09-06 10:37:57.780 TRACE 25484 --- [CommandProcessor-3] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, userId=user_001)
2022-09-06 10:37:57.784  INFO 25484 --- [CommandProcessor-3] .m.p.c.h.i.ProductLookupEventHandlerImpl : Reserve look up entity: ProductLookupEntity(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, productName=Product_001, productQuantity=94)
2022-09-06 10:37:57.785 TRACE 25484 --- [CommandProcessor-3] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, userId=user_001)
2022-09-06 10:37:57.791  INFO 25484 --- [CommandProcessor-3] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Reserve product quantity: ProductEntity(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, name=Product_001, description=Product_001, updatedAt=2022-09-06T10:37:57.791793, createdAt=2022-09-06T03:19:29.526196200Z, version=3, isActive=true, price=10.5, quantity=94)
2022-09-06 10:37:57.826 TRACE 14760 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command message: GenericCommandMessage{payload={ReserveProductCommand(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, userId=user_001)}, metadata={'traceId'->'220a401d-4f6c-4997-abc9-1d78f267619d', 'correlationId'->'187477de-62b8-4253-927f-18d855452bde'}, messageIdentifier='83626ca8-70d1-4a39-882c-8dcac4dca82e', commandName='com.liem.ms.coreservice.commands.ReserveProductCommand'}
2022-09-06 10:37:57.840 TRACE 14760 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'220a401d-4f6c-4997-abc9-1d78f267619d', 'correlationId'->'83626ca8-70d1-4a39-882c-8dcac4dca82e'}, messageIdentifier='851cd8e8-eeec-4343-aff2-aaa66acd230c', exception='null'}
2022-09-06 10:37:57.841  INFO 14760 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Reserved product '21801d8e-b57c-4fea-8437-3d7ec34a9c26' with reserved quantity 3 items
2022-09-06 10:37:57.859  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after reserve product: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, userId=user_001)
2022-09-06 10:37:57.862  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send user payment details query: FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 10:37:57.903  INFO 23664 --- [QueryProcessor-1] c.l.m.u.query.handler.UserEventsHandler  : Find user payment detail query handle; FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 10:37:57.935  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : User payment details query: User(firstName=Liem, lastName=Doan, userId=user_001, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123))
2022-09-06 10:37:57.953  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Schedule deadline for 'payment-process-deadline' by id '64910c2a-b96c-4645-bc75-f0b35aa8239c'
2022-09-06 10:37:57.957  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send payment process command: ProcessPaymentCommand(paymentId=ff9bb547-8e59-4749-8ea1-53549d23a89c, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=64910c2a-b96c-4645-bc75-f0b35aa8239c)
2022-09-06 10:37:57.968  INFO 13216 --- [CommandProcessor-1] c.l.m.p.core.PaymentAggregate            : Process payment command handle: ProcessPaymentCommand(paymentId=ff9bb547-8e59-4749-8ea1-53549d23a89c, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=64910c2a-b96c-4645-bc75-f0b35aa8239c)
2022-09-06 10:37:57.969  INFO 13216 --- [CommandProcessor-1] c.l.m.p.core.PaymentAggregate            : Payment processed event sourcing handle: PaymentProcessedEvent(paymentId=ff9bb547-8e59-4749-8ea1-53549d23a89c, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, paymentDetails=null, scheduleId=64910c2a-b96c-4645-bc75-f0b35aa8239c)
2022-09-06 10:37:57.985  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Payment process 'ff9bb547-8e59-4749-8ea1-53549d23a89c' completed
2022-09-06 10:37:57.997  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] c.l.m.p.q.handler.PaymentEventsHandler   : PaymentProcessedEvent is called for orderId: eccfa866-6d8c-49d6-bb8e-e45423795204
2022-09-06 10:37:58.028  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after payment process: PaymentProcessedEvent(paymentId=ff9bb547-8e59-4749-8ea1-53549d23a89c, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, paymentDetails=null, scheduleId=64910c2a-b96c-4645-bc75-f0b35aa8239c)
2022-09-06 10:37:58.029  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Send approve order command: ApproveOrderCommand(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204)
2022-09-06 10:37:58.031  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Cancel deadline for 'payment-process-deadline' by id '64910c2a-b96c-4645-bc75-f0b35aa8239c'
2022-09-06 10:37:58.075 TRACE 14760 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 10:37:58.079 TRACE 14760 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Approve order command handle: ApproveOrderCommand(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204)
2022-09-06 10:37:58.079 TRACE 14760 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order approve event sourcing handle: OrderApprovedEvent(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, orderStatus=APPROVED)
2022-09-06 10:37:58.082 TRACE 14760 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderApprovedEvent(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, orderStatus=APPROVED)
2022-09-06 10:37:58.092  INFO 14760 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Approve order: OrderEntity(id=eccfa866-6d8c-49d6-bb8e-e45423795204, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, rejectReason=null, orderStatus=APPROVED)
2022-09-06 10:37:58.117 TRACE 14760 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command message: GenericCommandMessage{payload={ApproveOrderCommand(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204)}, metadata={'traceId'->'220a401d-4f6c-4997-abc9-1d78f267619d', 'correlationId'->'c36f41c1-1dd3-4b04-9f0e-ddb8c2187035'}, messageIdentifier='97546fc9-2371-47f7-bdef-b48e2bce5242', commandName='com.liem.ms.orderservice.command.commands.ApproveOrderCommand'}
2022-09-06 10:37:58.117 TRACE 14760 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'220a401d-4f6c-4997-abc9-1d78f267619d', 'correlationId'->'97546fc9-2371-47f7-bdef-b48e2bce5242'}, messageIdentifier='7e0ec5f5-46c2-4b4e-886c-5626e9cc30f8', exception='null'}
2022-09-06 10:37:58.117  INFO 14760 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Approve order 'eccfa866-6d8c-49d6-bb8e-e45423795204' completed
2022-09-06 10:37:58.129  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Complete transaction : handle after approved order 'OrderApprovedEvent(orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, orderStatus=APPROVED)'
2022-09-06 10:38:31.314  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:38:37.833  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:40:19.844  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:40:49.224  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:43:31.315  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:43:37.834  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:45:19.847  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:45:49.226  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:48:31.316  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:48:37.836  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:50:19.851  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:50:49.227  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:53:31.318  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:53:37.837  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:55:19.853  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:55:49.229  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:58:31.320  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 10:58:37.839  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:00:19.854  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:00:49.230  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:03:31.323  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:03:37.841  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:05:19.855  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:05:49.232  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:08:31.325  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:08:37.843  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:10:19.856  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:10:49.233  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:13:31.325  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:13:37.844  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:15:19.857  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:15:49.234  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:18:31.327  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:18:37.845  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:20:19.859  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:20:49.236  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:23:31.329  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:23:37.847  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:25:19.861  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:25:49.237  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:28:31.330  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:28:37.848  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:30:19.862  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:30:49.239  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:33:31.331  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:33:37.848  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:35:19.863  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:35:49.241  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:38:31.333  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:38:37.851  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:40:19.865  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:40:49.243  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:43:31.334  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:43:37.852  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:45:19.867  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:45:49.243  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:48:31.336  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:48:37.854  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:50:19.869  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:50:49.244  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:53:31.337  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:53:37.855  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:55:19.869  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:55:49.245  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:58:31.340  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 11:58:37.857  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:00:19.871  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:00:49.247  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:03:31.341  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:03:37.859  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:05:19.873  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:05:49.250  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:08:31.343  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:08:37.861  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:10:19.876  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:10:49.253  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:13:31.344  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:13:37.862  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:15:19.879  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:15:49.255  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:18:31.345  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:18:37.865  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:20:19.881  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:20:49.256  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:23:31.348  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:23:37.867  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:25:19.883  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:25:49.257  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:28:31.350  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:28:37.869  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:30:19.884  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:30:49.259  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:33:31.353  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:33:37.871  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:35:19.885  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:35:49.261  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:38:31.355  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:38:37.873  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:40:19.887  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:40:49.263  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:43:31.356  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:43:37.875  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:45:19.888  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:45:49.265  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:48:31.358  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:48:37.877  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:50:19.891  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:50:49.266  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:53:31.359  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:53:37.878  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:55:19.891  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:55:49.267  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:58:31.360  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 12:58:37.881  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:00:19.893  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:00:49.270  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:03:31.362  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:03:37.883  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:05:19.894  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:05:49.272  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:08:31.364  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:08:37.885  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:10:19.897  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:10:49.274  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:13:31.365  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:13:37.888  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:15:19.899  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:15:49.275  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:18:31.367  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:18:37.889  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:20:19.901  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:20:49.276  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:23:31.369  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:23:37.890  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:25:19.902  INFO 14760 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:25:49.277  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:28:31.371  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:28:37.920  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:29:04.119  INFO 14760 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662445744119, current=DOWN, previous=UP]
2022-09-06 13:29:04.121  INFO 14760 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:f0c510bb67d8bc9ed42d75c69f46b9b6: registering service...
2022-09-06 13:29:04.146  INFO 14760 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:f0c510bb67d8bc9ed42d75c69f46b9b6 - registration status: 204
2022-09-06 13:29:04.570  INFO 14760 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderSagaImplProcessor'.
2022-09-06 13:29:04.572  INFO 14760 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderSagaImplProcessor' awaiting termination...
2022-09-06 13:29:04.596  INFO 14760 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.command.handler'.
2022-09-06 13:29:04.596  INFO 14760 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.command.handler' awaiting termination...
2022-09-06 13:29:04.597  INFO 14760 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.saga.handler.impl'.
2022-09-06 13:29:04.598  INFO 14760 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.saga.handler.impl' awaiting termination...
2022-09-06 13:29:04.896  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 13:29:04.897  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 13:29:04.899  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 13:29:04.900  INFO 14760 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 13:29:05.348  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 13:29:05.349  INFO 14760 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 13:29:05.367  INFO 14760 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 13:29:05.368  INFO 14760 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 13:29:05.369  INFO 14760 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 13:29:05.742  INFO 14760 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-09-06 13:29:05.752  INFO 14760 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-09-06 13:29:05.756  INFO 14760 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2022-09-06 13:29:08.768  INFO 14760 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2022-09-06 13:29:08.775  INFO 14760 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:f0c510bb67d8bc9ed42d75c69f46b9b6 - deregister  status: 200
2022-09-06 13:29:08.784  INFO 14760 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
2022-09-06 13:29:50.212  INFO 11204 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Starting OrderServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 11204 (D:\Work\event-driven-ms\order-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 13:29:50.214 DEBUG 11204 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 13:29:50.215  INFO 11204 --- [restartedMain] c.l.m.o.OrderServiceApplication          : The following 1 profile is active: "dev"
2022-09-06 13:29:55.864  INFO 11204 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 13:29:55.865  INFO 11204 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 13:29:56.044  INFO 11204 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring embedded WebApplicationContext
2022-09-06 13:29:56.950  INFO 11204 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 13:29:57.289  INFO 11204 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 13:29:57.537  INFO 11204 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 13:29:57.853  INFO 11204 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 13:29:58.848  INFO 11204 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 13:29:58.979  INFO 11204 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 13:29:59.109  INFO 11204 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 13:29:59.190  INFO 11204 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 13:29:59.376  INFO 11204 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 13:29:59.540  INFO 11204 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 13:30:00.420  INFO 11204 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 13:30:01.313  INFO 11204 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 13:30:01.315  INFO 11204 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 13:30:01.316  INFO 11204 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 13:30:01.317  INFO 11204 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 13:30:05.743  INFO 11204 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 13:30:06.572  INFO 11204 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 13:30:06.590  INFO 11204 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 13:30:06.615  INFO 11204 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : QueryChannel for context 'default' connected, 0 registrations resubscribed
2022-09-06 13:30:06.626  INFO 11204 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : Registered handler for query 'com.liem.ms.orderservice.query.queries.FindOrderQuery : com.liem.ms.orderservice.core.dto.OrderSummary' in context 'default'
2022-09-06 13:30:06.915  INFO 11204 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 13:30:06.918  INFO 11204 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 13:30:06.924  INFO 11204 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 13:30:06.924  INFO 11204 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 13:30:07.085  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 13:30:07.086  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 13:30:07.086  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 13:30:07.093  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.saga.handler.impl, segment=Segment[0/0]}
2022-09-06 13:30:07.093  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderSagaImplProcessor, segment=Segment[0/0]}
2022-09-06 13:30:07.094  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.command.handler, segment=Segment[0/0]}
2022-09-06 13:30:07.120  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=53} for segment: Segment[0/0]
2022-09-06 13:30:07.121  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=49} for segment: Segment[0/0]
2022-09-06 13:30:07.121  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=50} for segment: Segment[0/0]
2022-09-06 13:30:07.135  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 13:30:07.141  INFO 11204 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:30:07.205  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 13:30:07.206  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 13:30:07.206  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 13:30:07.206  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 13:30:07.207  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 13:30:07.207  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 13:30:07.207  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 13:30:07.664  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 13:30:07.669  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 13:30:07.672  INFO 11204 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 13:30:07.678  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662445807677 with initial instances count: 3
2022-09-06 13:30:07.687  INFO 11204 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662445807687, current=UP, previous=STARTING]
2022-09-06 13:30:07.689  INFO 11204 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:d69e60323fcb7b06235d25bf0e3e9897: registering service...
2022-09-06 13:30:07.744  INFO 11204 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:d69e60323fcb7b06235d25bf0e3e9897 - registration status: 204
2022-09-06 13:30:08.131  INFO 11204 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Started OrderServiceApplication in 18.94 seconds (JVM running for 21.545)
2022-09-06 13:30:08.678  INFO 11204 --- [RMI TCP Connection(8)-172.27.30.1] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 13:30:49.279  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:33:31.374  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:33:37.923  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:35:07.211  INFO 11204 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:35:49.280  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:38:31.375  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:38:37.925  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:39:33.780  INFO 11204 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Send create order command: OrderDto(id=null, userId=user_001, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, addressId=address_001, rejectReason=null, status=null)
2022-09-06 13:39:33.865 TRACE 11204 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Create order command handle: CreateOrderCommand(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, userId=user_001, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 13:39:33.888 TRACE 11204 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 13:39:33.918 TRACE 11204 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderCreatedEvent(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 13:39:33.918  INFO 11204 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Create order: OrderEntity(id=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, rejectReason=null, orderStatus=CREATED)
2022-09-06 13:39:33.989 TRACE 11204 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 13:39:33.989  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3)
2022-09-06 13:39:34.024  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Start transaction : handle after created order: OrderCreatedEvent(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 13:39:34.216 TRACE 25484 --- [CommandProcessor-4] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 13:39:34.220 TRACE 25484 --- [CommandProcessor-4] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001)
2022-09-06 13:39:34.221 TRACE 25484 --- [CommandProcessor-4] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, userId=user_001)
2022-09-06 13:39:34.223 TRACE 25484 --- [CommandProcessor-4] c.l.m.p.core.domain.ProductAggregate     : Reserve product command handle: ReserveProductCommand(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, userId=user_001)
2022-09-06 13:39:34.223 TRACE 25484 --- [CommandProcessor-4] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, userId=user_001)
2022-09-06 13:39:34.236 TRACE 25484 --- [CommandProcessor-4] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, userId=user_001)
2022-09-06 13:39:34.274  INFO 25484 --- [CommandProcessor-4] .m.p.c.h.i.ProductLookupEventHandlerImpl : Reserve look up entity: ProductLookupEntity(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, productName=Product_001, productQuantity=91)
2022-09-06 13:39:34.314 TRACE 25484 --- [CommandProcessor-4] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, userId=user_001)
2022-09-06 13:39:34.321  INFO 25484 --- [CommandProcessor-4] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Reserve product quantity: ProductEntity(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, name=Product_001, description=Product_001, updatedAt=2022-09-06T13:39:34.321313500, createdAt=2022-09-06T03:19:29.526196200Z, version=4, isActive=true, price=10.5, quantity=91)
2022-09-06 13:39:34.367  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after reserve product: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, userId=user_001)
2022-09-06 13:39:34.361 TRACE 11204 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command message: GenericCommandMessage{payload={ReserveProductCommand(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, userId=user_001)}, metadata={'traceId'->'434cb8c7-bfee-4649-9459-166f0cf7596b', 'correlationId'->'ca119c47-948f-4447-82ca-4a54c858b26c'}, messageIdentifier='bb319d62-b075-40f3-81f7-29f96eeeed23', commandName='com.liem.ms.coreservice.commands.ReserveProductCommand'}
2022-09-06 13:39:34.371 TRACE 11204 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'434cb8c7-bfee-4649-9459-166f0cf7596b', 'correlationId'->'bb319d62-b075-40f3-81f7-29f96eeeed23'}, messageIdentifier='f25c6b42-0ebc-4a28-befe-8d0c2bef73d7', exception='null'}
2022-09-06 13:39:34.371  INFO 11204 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Reserved product '21801d8e-b57c-4fea-8437-3d7ec34a9c26' with reserved quantity 3 items
2022-09-06 13:39:34.398  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send user payment details query: FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 13:39:34.481  INFO 23664 --- [QueryProcessor-2] c.l.m.u.query.handler.UserEventsHandler  : Find user payment detail query handle; FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 13:39:34.598  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : User payment details query: User(firstName=Liem, lastName=Doan, userId=user_001, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123))
2022-09-06 13:39:34.615  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Schedule deadline for 'payment-process-deadline' by id '37d41a08-6f00-4cd6-936a-118e30f3361f'
2022-09-06 13:39:34.647  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send payment process command: ProcessPaymentCommand(paymentId=de53751f-72b5-444a-a86f-96b0889a41d9, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=37d41a08-6f00-4cd6-936a-118e30f3361f)
2022-09-06 13:39:34.718  INFO 13216 --- [CommandProcessor-2] c.l.m.p.core.PaymentAggregate            : Process payment command handle: ProcessPaymentCommand(paymentId=de53751f-72b5-444a-a86f-96b0889a41d9, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=37d41a08-6f00-4cd6-936a-118e30f3361f)
2022-09-06 13:39:34.727  INFO 13216 --- [CommandProcessor-2] c.l.m.p.core.PaymentAggregate            : Payment processed event sourcing handle: PaymentProcessedEvent(paymentId=de53751f-72b5-444a-a86f-96b0889a41d9, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, paymentDetails=null, scheduleId=37d41a08-6f00-4cd6-936a-118e30f3361f)
2022-09-06 13:39:34.762  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Payment process 'de53751f-72b5-444a-a86f-96b0889a41d9' completed
2022-09-06 13:39:34.791  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] c.l.m.p.q.handler.PaymentEventsHandler   : PaymentProcessedEvent is called for orderId: 087190ff-eaf9-40ef-a43c-4d479fdbf4b4
2022-09-06 13:39:34.803  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after payment process: PaymentProcessedEvent(paymentId=de53751f-72b5-444a-a86f-96b0889a41d9, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, paymentDetails=null, scheduleId=37d41a08-6f00-4cd6-936a-118e30f3361f)
2022-09-06 13:39:34.805  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Send approve order command: ApproveOrderCommand(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4)
2022-09-06 13:39:34.806  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Cancel deadline for 'payment-process-deadline' by id '37d41a08-6f00-4cd6-936a-118e30f3361f'
2022-09-06 13:39:34.868 TRACE 11204 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, orderStatus=CREATED)
2022-09-06 13:39:34.873 TRACE 11204 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Approve order command handle: ApproveOrderCommand(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4)
2022-09-06 13:39:34.874 TRACE 11204 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order approve event sourcing handle: OrderApprovedEvent(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, orderStatus=APPROVED)
2022-09-06 13:39:34.880 TRACE 11204 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderApprovedEvent(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, orderStatus=APPROVED)
2022-09-06 13:39:34.887  INFO 11204 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Approve order: OrderEntity(id=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=3, addressId=address_001, rejectReason=null, orderStatus=APPROVED)
2022-09-06 13:39:34.906 TRACE 11204 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command message: GenericCommandMessage{payload={ApproveOrderCommand(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4)}, metadata={'traceId'->'434cb8c7-bfee-4649-9459-166f0cf7596b', 'correlationId'->'6b0256b0-68e5-4171-bb19-849226c414ad'}, messageIdentifier='2f6d1080-700a-493b-9145-56373c2cf472', commandName='com.liem.ms.orderservice.command.commands.ApproveOrderCommand'}
2022-09-06 13:39:34.907 TRACE 11204 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'434cb8c7-bfee-4649-9459-166f0cf7596b', 'correlationId'->'2f6d1080-700a-493b-9145-56373c2cf472'}, messageIdentifier='2d43c2c5-cb43-4b95-8eac-eb998137092a', exception='null'}
2022-09-06 13:39:34.907  INFO 11204 --- [grpc-default-executor-3] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Approve order '087190ff-eaf9-40ef-a43c-4d479fdbf4b4' completed
2022-09-06 13:39:34.925  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Complete transaction : handle after approved order 'OrderApprovedEvent(orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, orderStatus=APPROVED)'
2022-09-06 13:39:34.971  INFO 11204 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Query subscription close
2022-09-06 13:40:07.213  INFO 11204 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:40:49.282  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:43:31.376  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:43:37.926  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:45:07.215  INFO 11204 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:45:49.284  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:48:31.378  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:48:37.928  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:50:07.216  INFO 11204 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:50:49.284  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:53:31.380  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:53:37.931  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:55:07.218  INFO 11204 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:55:49.286  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:55:50.115  INFO 11204 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662447350115, current=DOWN, previous=UP]
2022-09-06 13:55:50.116  INFO 11204 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:d69e60323fcb7b06235d25bf0e3e9897: registering service...
2022-09-06 13:55:50.128  INFO 11204 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:d69e60323fcb7b06235d25bf0e3e9897 - registration status: 204
2022-09-06 13:55:50.342  INFO 11204 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderSagaImplProcessor'.
2022-09-06 13:55:50.342  INFO 11204 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderSagaImplProcessor' awaiting termination...
2022-09-06 13:55:50.347  INFO 11204 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.command.handler'.
2022-09-06 13:55:50.348  INFO 11204 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.command.handler' awaiting termination...
2022-09-06 13:55:50.349  INFO 11204 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.saga.handler.impl'.
2022-09-06 13:55:50.349  INFO 11204 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.saga.handler.impl' awaiting termination...
2022-09-06 13:55:50.914  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 13:55:50.915  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 13:55:50.915  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 13:55:50.915  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 13:55:50.915  INFO 11204 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 13:55:50.915  INFO 11204 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 13:55:50.923  INFO 11204 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 13:55:50.925  INFO 11204 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 13:55:50.926  INFO 11204 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 13:55:51.214  INFO 11204 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-09-06 13:55:51.225  INFO 11204 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-09-06 13:55:51.227  INFO 11204 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2022-09-06 13:55:54.230  INFO 11204 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2022-09-06 13:55:54.237  INFO 11204 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:d69e60323fcb7b06235d25bf0e3e9897 - deregister  status: 200
2022-09-06 13:55:54.243  INFO 11204 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
2022-09-06 13:56:05.075  INFO 10636 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Starting OrderServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 10636 (D:\Work\event-driven-ms\order-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 13:56:05.076 DEBUG 10636 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 13:56:05.077  INFO 10636 --- [restartedMain] c.l.m.o.OrderServiceApplication          : The following 1 profile is active: "dev"
2022-09-06 13:56:09.079  INFO 10636 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 13:56:09.080  INFO 10636 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 13:56:09.300  INFO 10636 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring embedded WebApplicationContext
2022-09-06 13:56:10.037  INFO 10636 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 13:56:10.233  INFO 10636 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 13:56:10.453  INFO 10636 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 13:56:10.595  INFO 10636 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 13:56:11.255  INFO 10636 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 13:56:11.332  INFO 10636 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 13:56:11.460  INFO 10636 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 13:56:11.537  INFO 10636 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 13:56:11.717  INFO 10636 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 13:56:11.865  INFO 10636 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 13:56:12.722  INFO 10636 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 13:56:13.580  INFO 10636 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 13:56:13.581  INFO 10636 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 13:56:13.582  INFO 10636 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 13:56:13.583  INFO 10636 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 13:56:18.241  INFO 10636 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 13:56:19.036  INFO 10636 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 13:56:19.054  INFO 10636 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 13:56:19.100  INFO 10636 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : QueryChannel for context 'default' connected, 0 registrations resubscribed
2022-09-06 13:56:19.111  INFO 10636 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : Registered handler for query 'com.liem.ms.orderservice.query.queries.FindOrderQuery : com.liem.ms.orderservice.core.dto.OrderSummary' in context 'default'
2022-09-06 13:56:19.396  INFO 10636 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 13:56:19.399  INFO 10636 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 13:56:19.405  INFO 10636 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 13:56:19.406  INFO 10636 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 13:56:19.575  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 13:56:19.575  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 13:56:19.576  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 13:56:19.584  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.saga.handler.impl, segment=Segment[0/0]}
2022-09-06 13:56:19.585  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.command.handler, segment=Segment[0/0]}
2022-09-06 13:56:19.585  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderSagaImplProcessor, segment=Segment[0/0]}
2022-09-06 13:56:19.614  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=57} for segment: Segment[0/0]
2022-09-06 13:56:19.615  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=53} for segment: Segment[0/0]
2022-09-06 13:56:19.615  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=54} for segment: Segment[0/0]
2022-09-06 13:56:19.633  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 13:56:19.665  INFO 10636 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:56:19.731  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 13:56:19.732  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 13:56:19.732  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 13:56:19.733  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 13:56:19.733  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 13:56:19.733  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 13:56:19.745  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 13:56:20.435  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 13:56:20.441  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 13:56:20.445  INFO 10636 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 13:56:20.454  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662447380452 with initial instances count: 3
2022-09-06 13:56:20.465  INFO 10636 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662447380465, current=UP, previous=STARTING]
2022-09-06 13:56:20.468  INFO 10636 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:8dfdaf8cb453d49f8b2c26a6cdd25bbe: registering service...
2022-09-06 13:56:20.534  INFO 10636 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:8dfdaf8cb453d49f8b2c26a6cdd25bbe - registration status: 204
2022-09-06 13:56:20.925  INFO 10636 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Started OrderServiceApplication in 16.882 seconds (JVM running for 18.952)
2022-09-06 13:56:21.461  INFO 10636 --- [RMI TCP Connection(5)-172.27.30.1] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 13:58:31.381  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 13:58:37.934  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:00:49.287  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:01:19.748  INFO 10636 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:03:31.382  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:03:37.935  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:05:49.289  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:06:19.751  INFO 10636 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:07:26.795  INFO 10636 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Send create order command: OrderDto(id=null, userId=user_001, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=300, addressId=address_001, rejectReason=null, status=null)
2022-09-06 14:07:26.848 TRACE 10636 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Create order command handle: CreateOrderCommand(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, userId=user_001, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:07:26.869 TRACE 10636 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:07:26.897 TRACE 10636 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderCreatedEvent(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:07:26.897  INFO 10636 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Create order: OrderEntity(id=c428c69e-1349-4ae7-979b-f9e3a5fdf131, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=300, addressId=address_001, rejectReason=null, orderStatus=CREATED)
2022-09-06 14:07:26.963 TRACE 10636 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:07:26.964  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=c428c69e-1349-4ae7-979b-f9e3a5fdf131, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=300)
2022-09-06 14:07:26.993  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Start transaction : handle after created order: OrderCreatedEvent(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:07:27.078 TRACE 25484 --- [CommandProcessor-5] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:07:27.081 TRACE 25484 --- [CommandProcessor-5] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=8bdd8f5b-7370-4c89-b542-606adaf062ab, userId=user_001)
2022-09-06 14:07:27.082 TRACE 25484 --- [CommandProcessor-5] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=eccfa866-6d8c-49d6-bb8e-e45423795204, userId=user_001)
2022-09-06 14:07:27.082 TRACE 25484 --- [CommandProcessor-5] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=3, orderId=087190ff-eaf9-40ef-a43c-4d479fdbf4b4, userId=user_001)
2022-09-06 14:07:27.083 TRACE 25484 --- [CommandProcessor-5] c.l.m.p.core.domain.ProductAggregate     : Reserve product command handle: ReserveProductCommand(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=300, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, userId=user_001)
2022-09-06 14:07:27.085 TRACE 25484 --- [CommandProcessor-5] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=300, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, userId=user_001)
2022-09-06 14:07:27.091 TRACE 25484 --- [CommandProcessor-5] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=300, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, userId=user_001)
2022-09-06 14:07:27.110  INFO 25484 --- [CommandProcessor-5] .m.p.c.h.i.ProductLookupEventHandlerImpl : Reserve look up entity: ProductLookupEntity(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, productName=Product_001, productQuantity=-209)
2022-09-06 14:07:27.112 TRACE 25484 --- [CommandProcessor-5] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=300, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, userId=user_001)
2022-09-06 14:07:27.119  INFO 25484 --- [CommandProcessor-5] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Reserve product quantity: ProductEntity(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, name=Product_001, description=Product_001, updatedAt=2022-09-06T14:07:27.119112700, createdAt=2022-09-06T03:19:29.526196200Z, version=5, isActive=true, price=10.5, quantity=-209)
2022-09-06 14:07:27.149 TRACE 10636 --- [grpc-default-executor-2] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command message: GenericCommandMessage{payload={ReserveProductCommand(productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=300, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, userId=user_001)}, metadata={'traceId'->'91c1b609-f3c2-4508-9a76-0efdc9c4ee59', 'correlationId'->'43baa075-9075-4930-b665-7a659594ebb5'}, messageIdentifier='063f27f9-4811-452a-a141-be60f4751ccb', commandName='com.liem.ms.coreservice.commands.ReserveProductCommand'}
2022-09-06 14:07:27.159 TRACE 10636 --- [grpc-default-executor-2] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'91c1b609-f3c2-4508-9a76-0efdc9c4ee59', 'correlationId'->'063f27f9-4811-452a-a141-be60f4751ccb'}, messageIdentifier='af396953-9139-41c3-8158-132800d13b92', exception='null'}
2022-09-06 14:07:27.159  INFO 10636 --- [grpc-default-executor-2] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Reserved product '21801d8e-b57c-4fea-8437-3d7ec34a9c26' with reserved quantity 300 items
2022-09-06 14:07:27.167  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after reserve product: ProductReservedEvent(id=21801d8e-b57c-4fea-8437-3d7ec34a9c26, quantity=300, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, userId=user_001)
2022-09-06 14:07:27.171  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send user payment details query: FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 14:07:27.215  INFO 23664 --- [QueryProcessor-3] c.l.m.u.query.handler.UserEventsHandler  : Find user payment detail query handle; FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 14:07:27.238  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : User payment details query: User(firstName=Liem, lastName=Doan, userId=user_001, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123))
2022-09-06 14:07:27.249  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Schedule deadline for 'payment-process-deadline' by id '268d4ac9-d296-4c8a-af54-237f625f597c'
2022-09-06 14:07:27.253  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send payment process command: ProcessPaymentCommand(paymentId=1733d4ba-587d-4cb0-98af-58fc736272da, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=268d4ac9-d296-4c8a-af54-237f625f597c)
2022-09-06 14:07:27.285  INFO 13216 --- [CommandProcessor-3] c.l.m.p.core.PaymentAggregate            : Process payment command handle: ProcessPaymentCommand(paymentId=1733d4ba-587d-4cb0-98af-58fc736272da, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=268d4ac9-d296-4c8a-af54-237f625f597c)
2022-09-06 14:07:27.288  INFO 13216 --- [CommandProcessor-3] c.l.m.p.core.PaymentAggregate            : Payment processed event sourcing handle: PaymentProcessedEvent(paymentId=1733d4ba-587d-4cb0-98af-58fc736272da, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, paymentDetails=null, scheduleId=268d4ac9-d296-4c8a-af54-237f625f597c)
2022-09-06 14:07:27.317  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Payment process '1733d4ba-587d-4cb0-98af-58fc736272da' completed
2022-09-06 14:07:27.333  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] c.l.m.p.q.handler.PaymentEventsHandler   : PaymentProcessedEvent is called for orderId: c428c69e-1349-4ae7-979b-f9e3a5fdf131
2022-09-06 14:07:27.356  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after payment process: PaymentProcessedEvent(paymentId=1733d4ba-587d-4cb0-98af-58fc736272da, orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, paymentDetails=null, scheduleId=268d4ac9-d296-4c8a-af54-237f625f597c)
2022-09-06 14:07:27.359  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Send approve order command: ApproveOrderCommand(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131)
2022-09-06 14:07:27.360  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Cancel deadline for 'payment-process-deadline' by id '268d4ac9-d296-4c8a-af54-237f625f597c'
2022-09-06 14:07:27.412 TRACE 10636 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:07:27.415 TRACE 10636 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Approve order command handle: ApproveOrderCommand(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131)
2022-09-06 14:07:27.415 TRACE 10636 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order approve event sourcing handle: OrderApprovedEvent(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, orderStatus=APPROVED)
2022-09-06 14:07:27.418 TRACE 10636 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderApprovedEvent(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, orderStatus=APPROVED)
2022-09-06 14:07:27.428  INFO 10636 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Approve order: OrderEntity(id=c428c69e-1349-4ae7-979b-f9e3a5fdf131, productId=21801d8e-b57c-4fea-8437-3d7ec34a9c26, userId=user_001, quantity=300, addressId=address_001, rejectReason=null, orderStatus=APPROVED)
2022-09-06 14:07:27.446 TRACE 10636 --- [grpc-default-executor-2] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command message: GenericCommandMessage{payload={ApproveOrderCommand(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131)}, metadata={'traceId'->'91c1b609-f3c2-4508-9a76-0efdc9c4ee59', 'correlationId'->'bbcdfb6e-cdd4-408c-985e-9e1a20376638'}, messageIdentifier='d075acee-0350-4b31-96ec-29e852171f45', commandName='com.liem.ms.orderservice.command.commands.ApproveOrderCommand'}
2022-09-06 14:07:27.446 TRACE 10636 --- [grpc-default-executor-2] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'91c1b609-f3c2-4508-9a76-0efdc9c4ee59', 'correlationId'->'d075acee-0350-4b31-96ec-29e852171f45'}, messageIdentifier='5a0c2b8d-57e2-4cfe-bad9-9662ec58670e', exception='null'}
2022-09-06 14:07:27.447  INFO 10636 --- [grpc-default-executor-2] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Approve order 'c428c69e-1349-4ae7-979b-f9e3a5fdf131' completed
2022-09-06 14:07:27.463  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Complete transaction : handle after approved order 'OrderApprovedEvent(orderId=c428c69e-1349-4ae7-979b-f9e3a5fdf131, orderStatus=APPROVED)'
2022-09-06 14:07:27.492  INFO 10636 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Query subscription close
2022-09-06 14:08:31.384  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:08:37.937  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:10:10.072  INFO 25484 --- [http-nio-8080-exec-3] c.l.m.p.c.s.i.ProductCommandServiceImpl  : Send create product command: ProductDto(price=10.5, quantity=100)
2022-09-06 14:10:10.101 TRACE 25484 --- [http-nio-8080-exec-3] .m.p.c.i.DeleteProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='093ca204-d5c6-465f-9759-5816d78392b7', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 14:10:10.103  INFO 25484 --- [http-nio-8080-exec-3] .m.p.c.i.DeleteProductCommandInterceptor : Pass to next dispatch interceptor
2022-09-06 14:10:10.104 TRACE 25484 --- [http-nio-8080-exec-3] m.p.c.i.ReserveProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='093ca204-d5c6-465f-9759-5816d78392b7', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 14:10:10.104  INFO 25484 --- [http-nio-8080-exec-3] m.p.c.i.ReserveProductCommandInterceptor : Pass to next dispatch interceptor
2022-09-06 14:10:10.105 TRACE 25484 --- [http-nio-8080-exec-3] .m.p.c.i.UpdateProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='093ca204-d5c6-465f-9759-5816d78392b7', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 14:10:10.106  INFO 25484 --- [http-nio-8080-exec-3] .m.p.c.i.UpdateProductCommandInterceptor : Pass to next dispatch interceptor
2022-09-06 14:10:10.107 TRACE 25484 --- [http-nio-8080-exec-3] .m.p.c.i.CreateProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='093ca204-d5c6-465f-9759-5816d78392b7', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 14:10:10.107  INFO 25484 --- [http-nio-8080-exec-3] .m.p.c.i.CreateProductCommandInterceptor : Create product command interceptor handle
2022-09-06 14:10:10.181  INFO 25484 --- [http-nio-8080-exec-3] .m.p.c.i.CreateProductCommandInterceptor : Product creation is valid
2022-09-06 14:10:10.241 TRACE 25484 --- [CommandProcessor-6] c.l.m.p.core.domain.ProductAggregate     : Create product command handle: CreateProductCommand(price=10.5, quantity=100)
2022-09-06 14:10:10.254 TRACE 25484 --- [CommandProcessor-6] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:10:10.265 TRACE 25484 --- [CommandProcessor-6] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:10:10.266  INFO 25484 --- [CommandProcessor-6] .m.p.c.h.i.ProductLookupEventHandlerImpl : Save look up entity: ProductLookupEntity(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, productName=Product_002, productQuantity=100)
2022-09-06 14:10:10.336 TRACE 25484 --- [CommandProcessor-6] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:10:10.337  INFO 25484 --- [CommandProcessor-6] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Create entity: ProductEntity(id=8d741c13-4e90-41f6-aac1-d72cc5e87c18, name=Product_002, description=Product_002, updatedAt=2022-09-06T07:10:10.337105Z, createdAt=2022-09-06T07:10:10.337105Z, version=1, isActive=true, price=10.5, quantity=100)
2022-09-06 14:10:49.291  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:11:19.753  INFO 10636 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:13:31.386  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:13:37.940  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:15:49.293  INFO 25484 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:16:17.287  INFO 25484 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662448577287, current=DOWN, previous=UP]
2022-09-06 14:16:17.290  INFO 25484 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:18cf38e1522b5203709882db18e4c6b0: registering service...
2022-09-06 14:16:17.312  INFO 25484 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:18cf38e1522b5203709882db18e4c6b0 - registration status: 204
2022-09-06 14:16:17.743  INFO 25484 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.productservice.command.commands.product.CreateProductCommand' in context 'default'
2022-09-06 14:16:17.745  INFO 25484 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.coreservice.commands.ReserveProductCommand' in context 'default'
2022-09-06 14:16:17.745  INFO 25484 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.productservice.command.commands.product.SupplyProductCommand' in context 'default'
2022-09-06 14:16:17.746  INFO 25484 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.coreservice.commands.CancelProductReserveCommand' in context 'default'
2022-09-06 14:16:17.746  INFO 25484 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.productservice.command.commands.product.UpdateProductCommand' in context 'default'
2022-09-06 14:16:17.746  INFO 25484 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.productservice.command.commands.common.DeleteCommand' in context 'default'
2022-09-06 14:16:18.095  INFO 25484 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-09-06 14:16:18.104  INFO 25484 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-09-06 14:16:18.108  INFO 25484 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2022-09-06 14:16:19.754  INFO 10636 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:16:21.112  INFO 25484 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2022-09-06 14:16:21.119  INFO 25484 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:18cf38e1522b5203709882db18e4c6b0 - deregister  status: 200
2022-09-06 14:16:21.130  INFO 25484 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
2022-09-06 14:16:36.073  INFO 1216 --- [restartedMain] c.l.m.p.ProductServiceApplication        : Starting ProductServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 1216 (D:\Work\event-driven-ms\product-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 14:16:36.076 DEBUG 1216 --- [restartedMain] c.l.m.p.ProductServiceApplication        : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 14:16:36.077  INFO 1216 --- [restartedMain] c.l.m.p.ProductServiceApplication        : The following 1 profile is active: "dev"
2022-09-06 14:16:41.332  INFO 1216 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 14:16:41.333  INFO 1216 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 14:16:41.521  INFO 1216 --- [restartedMain] o.a.c.c.C.[.[localhost].[/product]       : Initializing Spring embedded WebApplicationContext
2022-09-06 14:16:42.445  INFO 1216 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 14:16:42.630  INFO 1216 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 14:16:42.832  INFO 1216 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 14:16:42.970  INFO 1216 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 14:16:43.652  INFO 1216 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 14:16:43.760  INFO 1216 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 14:16:43.897  INFO 1216 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 14:16:44.018  INFO 1216 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 14:16:44.267  INFO 1216 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 14:16:44.415  INFO 1216 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 14:16:45.402  INFO 1216 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 14:16:45.434 TRACE 1216 --- [restartedMain] c.l.m.p.c.config.HandlerConfiguration    : Handler registration: com.liem.ms.productservice.command.handler.impl.ProductEventErrorHandler@6528f184
2022-09-06 14:16:45.879  INFO 1216 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 14:16:45.880  INFO 1216 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 14:16:45.881  INFO 1216 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 14:16:45.882  INFO 1216 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 14:16:45.937 TRACE 1216 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.DeleteProductCommandInterceptor@6cb6ecb
2022-09-06 14:16:46.654 TRACE 1216 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.CreateProductCommandInterceptor@42f2c740
2022-09-06 14:16:46.659 TRACE 1216 --- [restartedMain] c.l.m.p.c.c.InterceptorConfiguration     : Handler registration: com.liem.ms.productservice.command.interceptor.UpdateProductCommandInterceptor@5b855f2b
2022-09-06 14:16:51.720  INFO 1216 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 14:16:52.674  INFO 1216 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 14:16:52.703  INFO 1216 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 14:16:52.737  INFO 1216 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : QueryChannel for context 'default' connected, 0 registrations resubscribed
2022-09-06 14:16:52.749  INFO 1216 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : Registered handler for query 'com.liem.ms.productservice.query.queries.FindProductQuery : java.util.List<com.liem.ms.productservice.query.entity.ProductEntity>' in context 'default'
2022-09-06 14:16:52.841  INFO 1216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 14:16:52.844  INFO 1216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.product.CreateProductCommand' in context 'default'
2022-09-06 14:16:52.854  INFO 1216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.ReserveProductCommand' in context 'default'
2022-09-06 14:16:52.856  INFO 1216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.product.SupplyProductCommand' in context 'default'
2022-09-06 14:16:52.857  INFO 1216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.CancelProductReserveCommand' in context 'default'
2022-09-06 14:16:52.858  INFO 1216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.product.UpdateProductCommand' in context 'default'
2022-09-06 14:16:52.860  INFO 1216 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.productservice.command.commands.common.DeleteCommand' in context 'default'
2022-09-06 14:16:53.019  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 14:16:53.024  INFO 1216 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:16:53.057  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 14:16:53.057  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 14:16:53.057  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 14:16:53.057  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 14:16:53.057  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 14:16:53.058  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 14:16:53.058  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 14:16:53.591  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 14:16:53.595  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 14:16:53.599  INFO 1216 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 14:16:53.606  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662448613605 with initial instances count: 3
2022-09-06 14:16:53.617  INFO 1216 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662448613617, current=UP, previous=STARTING]
2022-09-06 14:16:53.619  INFO 1216 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:b5e54c4ce364326ada771131d8c6948c: registering service...
2022-09-06 14:16:53.675  INFO 1216 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PRODUCT-SERVICE/product-service:b5e54c4ce364326ada771131d8c6948c - registration status: 204
2022-09-06 14:16:54.026  INFO 1216 --- [restartedMain] c.l.m.p.ProductServiceApplication        : Started ProductServiceApplication in 19.217 seconds (JVM running for 21.658)
2022-09-06 14:16:54.522  INFO 1216 --- [RMI TCP Connection(12)-172.27.30.1] o.a.c.c.C.[.[localhost].[/product]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 14:18:31.389  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:18:37.941  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:21:19.757  INFO 10636 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:21:53.059  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:22:26.691  INFO 10636 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662448946691, current=DOWN, previous=UP]
2022-09-06 14:22:26.692  INFO 10636 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:8dfdaf8cb453d49f8b2c26a6cdd25bbe: registering service...
2022-09-06 14:22:26.705  INFO 10636 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:8dfdaf8cb453d49f8b2c26a6cdd25bbe - registration status: 204
2022-09-06 14:22:26.917  INFO 10636 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderSagaImplProcessor'.
2022-09-06 14:22:26.918  INFO 10636 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderSagaImplProcessor' awaiting termination...
2022-09-06 14:22:26.923  INFO 10636 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.command.handler'.
2022-09-06 14:22:26.923  INFO 10636 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.command.handler' awaiting termination...
2022-09-06 14:22:26.924  INFO 10636 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.saga.handler.impl'.
2022-09-06 14:22:26.924  INFO 10636 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.saga.handler.impl' awaiting termination...
2022-09-06 14:22:26.975  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 14:22:26.976  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 14:22:27.283  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 14:22:27.284  INFO 10636 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 14:22:27.355  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 14:22:27.355  INFO 10636 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 14:22:27.363  INFO 10636 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 14:22:27.364  INFO 10636 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 14:22:27.364  INFO 10636 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 14:22:27.531  INFO 10636 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-09-06 14:22:27.539  INFO 10636 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-09-06 14:22:27.541  INFO 10636 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2022-09-06 14:22:30.545  INFO 10636 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2022-09-06 14:22:30.552  INFO 10636 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:8dfdaf8cb453d49f8b2c26a6cdd25bbe - deregister  status: 200
2022-09-06 14:22:30.557  INFO 10636 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
2022-09-06 14:22:41.699  INFO 21940 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Starting OrderServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 21940 (D:\Work\event-driven-ms\order-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 14:22:41.701 DEBUG 21940 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 14:22:41.701  INFO 21940 --- [restartedMain] c.l.m.o.OrderServiceApplication          : The following 1 profile is active: "dev"
2022-09-06 14:22:46.084  INFO 21940 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 14:22:46.085  INFO 21940 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 14:22:46.317  INFO 21940 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring embedded WebApplicationContext
2022-09-06 14:22:47.363  INFO 21940 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 14:22:47.578  INFO 21940 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 14:22:47.802  INFO 21940 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 14:22:47.967  INFO 21940 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 14:22:48.723  INFO 21940 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 14:22:48.820  INFO 21940 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 14:22:48.982  INFO 21940 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 14:22:49.051  INFO 21940 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 14:22:49.219  INFO 21940 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 14:22:49.358  INFO 21940 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 14:22:50.167  INFO 21940 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 14:22:51.046  INFO 21940 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 14:22:51.047  INFO 21940 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 14:22:51.049  INFO 21940 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 14:22:51.050  INFO 21940 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 14:22:55.543  INFO 21940 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 14:22:56.307  INFO 21940 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 14:22:56.324  INFO 21940 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 14:22:56.352  INFO 21940 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : QueryChannel for context 'default' connected, 0 registrations resubscribed
2022-09-06 14:22:56.361  INFO 21940 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : Registered handler for query 'com.liem.ms.orderservice.query.queries.FindOrderQuery : com.liem.ms.orderservice.core.dto.OrderSummary' in context 'default'
2022-09-06 14:22:56.637  INFO 21940 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 14:22:56.639  INFO 21940 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 14:22:56.646  INFO 21940 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 14:22:56.647  INFO 21940 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 14:22:56.828  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 14:22:56.829  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 14:22:56.831  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 14:22:56.857  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.command.handler, segment=Segment[0/0]}
2022-09-06 14:22:56.865  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.saga.handler.impl, segment=Segment[0/0]}
2022-09-06 14:22:56.865  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderSagaImplProcessor, segment=Segment[0/0]}
2022-09-06 14:22:56.901  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=62} for segment: Segment[0/0]
2022-09-06 14:22:56.904  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=62} for segment: Segment[0/0]
2022-09-06 14:22:56.904  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=62} for segment: Segment[0/0]
2022-09-06 14:22:56.905  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 14:22:56.915  INFO 21940 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:22:57.011  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 14:22:57.012  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 14:22:57.012  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 14:22:57.013  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 14:22:57.013  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 14:22:57.013  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 14:22:57.013  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 14:22:57.431  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 14:22:57.436  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 14:22:57.439  INFO 21940 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 14:22:57.446  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662448977445 with initial instances count: 4
2022-09-06 14:22:57.453  INFO 21940 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662448977453, current=UP, previous=STARTING]
2022-09-06 14:22:57.456  INFO 21940 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:7cbc0f8318259d3bace6f67c96472b69: registering service...
2022-09-06 14:22:57.505  INFO 21940 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:7cbc0f8318259d3bace6f67c96472b69 - registration status: 204
2022-09-06 14:22:57.813  INFO 21940 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Started OrderServiceApplication in 17.404 seconds (JVM running for 20.387)
2022-09-06 14:22:58.211  INFO 21940 --- [RMI TCP Connection(5)-172.27.30.1] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 14:23:31.391  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:23:37.942  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:26:15.493  INFO 21940 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Send create order command: OrderDto(id=null, userId=user_001, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, addressId=address_001, rejectReason=null, status=null)
2022-09-06 14:26:15.566 TRACE 21940 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Create order command handle: CreateOrderCommand(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, userId=user_001, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:15.589 TRACE 21940 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:15.629 TRACE 21940 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderCreatedEvent(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:15.629  INFO 21940 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Create order: OrderEntity(id=f41a8c29-820c-4f11-82ef-313c3455a394, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, rejectReason=null, orderStatus=CREATED)
2022-09-06 14:26:15.730 TRACE 21940 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:15.730  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=f41a8c29-820c-4f11-82ef-313c3455a394, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300)
2022-09-06 14:26:15.759  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Start transaction : handle after created order: OrderCreatedEvent(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:15.906 TRACE 1216 --- [CommandProcessor-0] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:26:15.911 TRACE 1216 --- [CommandProcessor-0] c.l.m.p.core.domain.ProductAggregate     : Reserve product command handle: ReserveProductCommand(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=f41a8c29-820c-4f11-82ef-313c3455a394, userId=user_001)
2022-09-06 14:26:16.127 ERROR 1216 --- [CommandProcessor-0] c.l.m.p.core.domain.ProductAggregate     : Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items
2022-09-06 14:26:16.163 TRACE 21940 --- [grpc-default-executor-2] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command message: GenericCommandMessage{payload={ReserveProductCommand(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=f41a8c29-820c-4f11-82ef-313c3455a394, userId=user_001)}, metadata={'traceId'->'0fe6a0c3-a4cf-4f2f-b56f-92b815d73a9e', 'correlationId'->'e81d3b4c-4e83-41f2-a620-7435e501c899'}, messageIdentifier='5ab38fc0-b667-4168-802d-b87cfb1762d3', commandName='com.liem.ms.coreservice.commands.ReserveProductCommand'}
2022-09-06 14:26:16.173 TRACE 21940 --- [grpc-default-executor-2] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'0fe6a0c3-a4cf-4f2f-b56f-92b815d73a9e', 'correlationId'->'5ab38fc0-b667-4168-802d-b87cfb1762d3'}, messageIdentifier='03229f21-f88b-4d70-9a8f-05ae92c0c5ec', exception='org.axonframework.commandhandling.CommandExecutionException: Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items'}
2022-09-06 14:26:16.173 ERROR 21940 --- [grpc-default-executor-2] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Reserved product failed: Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items
2022-09-06 14:26:16.218 TRACE 1216 --- [CommandProcessor-1] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:26:16.219 TRACE 1216 --- [CommandProcessor-1] c.l.m.p.core.domain.ProductAggregate     : Cancel product reserve command handle: CancelProductReserveCommand(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=f41a8c29-820c-4f11-82ef-313c3455a394, userId=user_001, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)
2022-09-06 14:26:16.238 TRACE 1216 --- [CommandProcessor-1] c.l.m.p.core.domain.ProductAggregate     : Product cancel reserve event sourcing handle: ProductCancelReserveEvent(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=f41a8c29-820c-4f11-82ef-313c3455a394, userId=user_001, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)
2022-09-06 14:26:16.271 TRACE 1216 --- [CommandProcessor-1] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductCancelReserveEvent(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=f41a8c29-820c-4f11-82ef-313c3455a394, userId=user_001, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)
2022-09-06 14:26:16.276  INFO 1216 --- [CommandProcessor-1] .m.p.c.h.i.ProductLookupEventHandlerImpl : Cancel reservation look up entity: ProductLookupEntity(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, productName=Product_002, productQuantity=400)
2022-09-06 14:26:16.344  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after cancel product reservation process: ProductCancelReserveEvent(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=f41a8c29-820c-4f11-82ef-313c3455a394, userId=user_001, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)
2022-09-06 14:26:16.370  INFO 21940 --- [grpc-default-executor-2] .s.i.CancelProductReservationServiceImpl : Cancel product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' reservation completed
2022-09-06 14:26:16.402 TRACE 21940 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:16.409 TRACE 21940 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Reject order command handle: RejectOrderCommand(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)
2022-09-06 14:26:16.411 TRACE 21940 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order reject event sourcing handle: OrderRejectedEvent(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, orderStatus=REJECTED, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)
2022-09-06 14:26:16.419 TRACE 21940 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderRejectedEvent(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, orderStatus=REJECTED, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)
2022-09-06 14:26:16.431  INFO 21940 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Reject order: OrderEntity(id=f41a8c29-820c-4f11-82ef-313c3455a394, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, rejectReason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items, orderStatus=REJECTED)
2022-09-06 14:26:16.455 TRACE 21940 --- [grpc-default-executor-4] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Command message: GenericCommandMessage{payload={RejectOrderCommand(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)}, metadata={'traceId'->'91c24e28-7604-468a-8210-b0559fdaff05', 'correlationId'->'be105f74-f2c0-4f9e-a2ca-7f098cf8567b'}, messageIdentifier='01dda860-b4c6-4e2b-8acd-bcb4de322fe8', commandName='com.liem.ms.orderservice.command.commands.RejectOrderCommand'}
2022-09-06 14:26:16.456 TRACE 21940 --- [grpc-default-executor-4] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'91c24e28-7604-468a-8210-b0559fdaff05', 'correlationId'->'01dda860-b4c6-4e2b-8acd-bcb4de322fe8'}, messageIdentifier='3edaf989-b7a0-4e40-b285-d11eb0ba6830', exception='null'}
2022-09-06 14:26:16.456  INFO 21940 --- [grpc-default-executor-4] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Reject order completed
2022-09-06 14:26:16.479  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Complete transaction : handle after reject order: OrderRejectedEvent(orderId=f41a8c29-820c-4f11-82ef-313c3455a394, orderStatus=REJECTED, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)
2022-09-06 14:26:16.504  INFO 21940 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Query subscription close
2022-09-06 14:26:16.510  INFO 21940 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Send create order command: OrderDto(id=null, userId=user_001, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, addressId=address_001, rejectReason=null, status=null)
2022-09-06 14:26:16.516 TRACE 21940 --- [CommandProcessor-2] c.l.m.o.core.domain.OrderAggregate       : Create order command handle: CreateOrderCommand(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, userId=user_001, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:16.517 TRACE 21940 --- [CommandProcessor-2] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:16.521 TRACE 21940 --- [CommandProcessor-2] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderCreatedEvent(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:16.522  INFO 21940 --- [CommandProcessor-2] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Create order: OrderEntity(id=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, rejectReason=null, orderStatus=CREATED)
2022-09-06 14:26:16.546 TRACE 21940 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:16.546  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Start transaction : handle after created order: OrderCreatedEvent(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:16.547  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300)
2022-09-06 14:26:16.577 TRACE 1216 --- [CommandProcessor-2] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:26:16.578 TRACE 1216 --- [CommandProcessor-2] c.l.m.p.core.domain.ProductAggregate     : Product cancel reserve event sourcing handle: ProductCancelReserveEvent(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=f41a8c29-820c-4f11-82ef-313c3455a394, userId=user_001, reason=Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items)
2022-09-06 14:26:16.579 TRACE 1216 --- [CommandProcessor-2] c.l.m.p.core.domain.ProductAggregate     : Reserve product command handle: ReserveProductCommand(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, userId=user_001)
2022-09-06 14:26:16.582  INFO 1216 --- [CommandProcessor-2] c.l.m.p.core.domain.ProductAggregate     : Product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' is insufficient by reserved quantity 300 items
2022-09-06 14:26:16.592 TRACE 1216 --- [CommandProcessor-2] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, userId=user_001)
2022-09-06 14:26:16.595 TRACE 1216 --- [CommandProcessor-2] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductReservedEvent(id=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, userId=user_001)
2022-09-06 14:26:16.599  INFO 1216 --- [CommandProcessor-2] .m.p.c.h.i.ProductLookupEventHandlerImpl : Reserve look up entity: ProductLookupEntity(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, productName=Product_002, productQuantity=100)
2022-09-06 14:26:16.603 TRACE 1216 --- [CommandProcessor-2] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductReservedEvent(id=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, userId=user_001)
2022-09-06 14:26:16.632  INFO 1216 --- [CommandProcessor-2] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Reserve product quantity: ProductEntity(id=8d741c13-4e90-41f6-aac1-d72cc5e87c18, name=Product_002, description=Product_002, updatedAt=2022-09-06T14:26:16.632815100, createdAt=2022-09-06T07:10:10.337105Z, version=2, isActive=true, price=10.5, quantity=-200)
2022-09-06 14:26:16.697 TRACE 21940 --- [grpc-default-executor-1] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command message: GenericCommandMessage{payload={ReserveProductCommand(productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, userId=user_001)}, metadata={'traceId'->'63b1c135-a8c1-495c-a763-8ccb93e97e1c', 'correlationId'->'ad63bf04-ef2c-42cb-9180-b50ae3c119a3'}, messageIdentifier='3f2d64d6-7709-4d2c-a0a7-056026232cf4', commandName='com.liem.ms.coreservice.commands.ReserveProductCommand'}
2022-09-06 14:26:16.699 TRACE 21940 --- [grpc-default-executor-1] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'63b1c135-a8c1-495c-a763-8ccb93e97e1c', 'correlationId'->'3f2d64d6-7709-4d2c-a0a7-056026232cf4'}, messageIdentifier='412ff55d-d2d0-4f1b-8a12-e1415e9759f1', exception='null'}
2022-09-06 14:26:16.699  INFO 21940 --- [grpc-default-executor-1] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Reserved product '8d741c13-4e90-41f6-aac1-d72cc5e87c18' with reserved quantity 300 items
2022-09-06 14:26:16.710  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after reserve product: ProductReservedEvent(id=8d741c13-4e90-41f6-aac1-d72cc5e87c18, quantity=300, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, userId=user_001)
2022-09-06 14:26:16.713  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send user payment details query: FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 14:26:16.761  INFO 23664 --- [QueryProcessor-4] c.l.m.u.query.handler.UserEventsHandler  : Find user payment detail query handle; FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 14:26:16.782  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : User payment details query: User(firstName=Liem, lastName=Doan, userId=user_001, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123))
2022-09-06 14:26:16.795  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Schedule deadline for 'payment-process-deadline' by id '7f107b08-12ab-408c-8982-d654f60e18d6'
2022-09-06 14:26:16.799  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send payment process command: ProcessPaymentCommand(paymentId=59c196d2-16e8-4da9-9187-0d722a7c5727, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=7f107b08-12ab-408c-8982-d654f60e18d6)
2022-09-06 14:26:16.836  INFO 13216 --- [CommandProcessor-4] c.l.m.p.core.PaymentAggregate            : Process payment command handle: ProcessPaymentCommand(paymentId=59c196d2-16e8-4da9-9187-0d722a7c5727, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=7f107b08-12ab-408c-8982-d654f60e18d6)
2022-09-06 14:26:16.840  INFO 13216 --- [CommandProcessor-4] c.l.m.p.core.PaymentAggregate            : Payment processed event sourcing handle: PaymentProcessedEvent(paymentId=59c196d2-16e8-4da9-9187-0d722a7c5727, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, paymentDetails=null, scheduleId=7f107b08-12ab-408c-8982-d654f60e18d6)
2022-09-06 14:26:16.863  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Payment process '59c196d2-16e8-4da9-9187-0d722a7c5727' completed
2022-09-06 14:26:16.875  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] c.l.m.p.q.handler.PaymentEventsHandler   : PaymentProcessedEvent is called for orderId: 21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced
2022-09-06 14:26:16.902  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after payment process: PaymentProcessedEvent(paymentId=59c196d2-16e8-4da9-9187-0d722a7c5727, orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, paymentDetails=null, scheduleId=7f107b08-12ab-408c-8982-d654f60e18d6)
2022-09-06 14:26:16.905  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Send approve order command: ApproveOrderCommand(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced)
2022-09-06 14:26:16.907  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Cancel deadline for 'payment-process-deadline' by id '7f107b08-12ab-408c-8982-d654f60e18d6'
2022-09-06 14:26:16.936 TRACE 21940 --- [CommandProcessor-3] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:26:16.938 TRACE 21940 --- [CommandProcessor-3] c.l.m.o.core.domain.OrderAggregate       : Approve order command handle: ApproveOrderCommand(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced)
2022-09-06 14:26:16.940 TRACE 21940 --- [CommandProcessor-3] c.l.m.o.core.domain.OrderAggregate       : Order approve event sourcing handle: OrderApprovedEvent(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, orderStatus=APPROVED)
2022-09-06 14:26:16.946 TRACE 21940 --- [CommandProcessor-3] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderApprovedEvent(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, orderStatus=APPROVED)
2022-09-06 14:26:16.949  INFO 21940 --- [CommandProcessor-3] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Approve order: OrderEntity(id=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, productId=8d741c13-4e90-41f6-aac1-d72cc5e87c18, userId=user_001, quantity=300, addressId=address_001, rejectReason=null, orderStatus=APPROVED)
2022-09-06 14:26:16.984 TRACE 21940 --- [grpc-default-executor-4] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command message: GenericCommandMessage{payload={ApproveOrderCommand(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced)}, metadata={'traceId'->'63b1c135-a8c1-495c-a763-8ccb93e97e1c', 'correlationId'->'7c4b19a6-21ee-40f8-8916-b550eabfee1e'}, messageIdentifier='665e0833-1833-4a95-b6e7-955dc1a2b282', commandName='com.liem.ms.orderservice.command.commands.ApproveOrderCommand'}
2022-09-06 14:26:16.984 TRACE 21940 --- [grpc-default-executor-4] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'63b1c135-a8c1-495c-a763-8ccb93e97e1c', 'correlationId'->'665e0833-1833-4a95-b6e7-955dc1a2b282'}, messageIdentifier='7c6d47b3-f50b-4ea7-a1dd-484f4649ef31', exception='null'}
2022-09-06 14:26:16.984  INFO 21940 --- [grpc-default-executor-4] c.l.m.o.s.s.i.ApproveOrderServiceImpl    : Approve order '21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced' completed
2022-09-06 14:26:17.000  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Complete transaction : handle after approved order 'OrderApprovedEvent(orderId=21eb0a6a-9cf0-47e0-8d9c-94f1458a4ced, orderStatus=APPROVED)'
2022-09-06 14:26:17.018  INFO 21940 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Query subscription close
2022-09-06 14:26:53.062  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:27:13.227  INFO 21940 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662449233227, current=DOWN, previous=UP]
2022-09-06 14:27:13.228  INFO 21940 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:7cbc0f8318259d3bace6f67c96472b69: registering service...
2022-09-06 14:27:13.235  INFO 21940 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:7cbc0f8318259d3bace6f67c96472b69 - registration status: 204
2022-09-06 14:27:13.446  INFO 21940 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderSagaImplProcessor'.
2022-09-06 14:27:13.446  INFO 21940 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderSagaImplProcessor' awaiting termination...
2022-09-06 14:27:13.452  INFO 21940 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.command.handler'.
2022-09-06 14:27:13.452  INFO 21940 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.command.handler' awaiting termination...
2022-09-06 14:27:13.453  INFO 21940 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.saga.handler.impl'.
2022-09-06 14:27:13.453  INFO 21940 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.saga.handler.impl' awaiting termination...
2022-09-06 14:27:13.764  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 14:27:13.766  INFO 21940 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 14:27:13.997  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 14:27:13.997  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 14:27:14.001  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 14:27:14.002  INFO 21940 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 14:27:14.026  INFO 21940 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 14:27:14.028  INFO 21940 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 14:27:14.030  INFO 21940 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 14:27:14.545  INFO 21940 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-09-06 14:27:14.553  INFO 21940 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-09-06 14:27:14.554  INFO 21940 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2022-09-06 14:27:17.557  INFO 21940 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2022-09-06 14:27:17.567  INFO 21940 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:7cbc0f8318259d3bace6f67c96472b69 - deregister  status: 200
2022-09-06 14:27:17.574  INFO 21940 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
2022-09-06 14:27:26.828  INFO 10468 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Starting OrderServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 10468 (D:\Work\event-driven-ms\order-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 14:27:26.829 DEBUG 10468 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 14:27:26.830  INFO 10468 --- [restartedMain] c.l.m.o.OrderServiceApplication          : The following 1 profile is active: "dev"
2022-09-06 14:27:30.552  INFO 10468 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 14:27:30.552  INFO 10468 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 14:27:30.739  INFO 10468 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring embedded WebApplicationContext
2022-09-06 14:27:31.480  INFO 10468 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 14:27:31.669  INFO 10468 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 14:27:31.885  INFO 10468 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 14:27:32.025  INFO 10468 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 14:27:32.783  INFO 10468 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 14:27:32.876  INFO 10468 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 14:27:33.036  INFO 10468 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 14:27:33.120  INFO 10468 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 14:27:33.290  INFO 10468 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 14:27:33.445  INFO 10468 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 14:27:34.512  INFO 10468 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 14:27:35.562  INFO 10468 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 14:27:35.564  INFO 10468 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 14:27:35.566  INFO 10468 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 14:27:35.567  INFO 10468 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 14:27:40.288  INFO 10468 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 14:27:41.091  INFO 10468 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 14:27:41.108  INFO 10468 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 14:27:41.135  INFO 10468 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : QueryChannel for context 'default' connected, 0 registrations resubscribed
2022-09-06 14:27:41.144  INFO 10468 --- [restartedMain] i.a.a.c.query.impl.QueryChannelImpl      : Registered handler for query 'com.liem.ms.orderservice.query.queries.FindOrderQuery : com.liem.ms.orderservice.core.dto.OrderSummary' in context 'default'
2022-09-06 14:27:41.399  INFO 10468 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 14:27:41.402  INFO 10468 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 14:27:41.409  INFO 10468 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 14:27:41.410  INFO 10468 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 14:27:41.595  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 14:27:41.597  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 14:27:41.597  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 14:27:41.604  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=OrderSagaImplProcessor, segment=Segment[0/0]}
2022-09-06 14:27:41.605  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.command.handler, segment=Segment[0/0]}
2022-09-06 14:27:41.605  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.orderservice.saga.handler.impl, segment=Segment[0/0]}
2022-09-06 14:27:41.636  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=69} for segment: Segment[0/0]
2022-09-06 14:27:41.638  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=69} for segment: Segment[0/0]
2022-09-06 14:27:41.640  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=69} for segment: Segment[0/0]
2022-09-06 14:27:41.659  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 14:27:41.668  INFO 10468 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:27:41.734  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 14:27:41.735  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 14:27:41.735  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 14:27:41.736  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 14:27:41.736  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 14:27:41.736  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 14:27:41.736  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 14:27:42.154  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 14:27:42.158  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 14:27:42.161  INFO 10468 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 14:27:42.168  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662449262167 with initial instances count: 3
2022-09-06 14:27:42.177  INFO 10468 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662449262177, current=UP, previous=STARTING]
2022-09-06 14:27:42.180  INFO 10468 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:61d5a1b1c9a7dfc71d15a308bec0e528: registering service...
2022-09-06 14:27:42.236  INFO 10468 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:61d5a1b1c9a7dfc71d15a308bec0e528 - registration status: 204
2022-09-06 14:27:42.645  INFO 10468 --- [restartedMain] c.l.m.o.OrderServiceApplication          : Started OrderServiceApplication in 16.88 seconds (JVM running for 18.786)
2022-09-06 14:27:43.058  INFO 10468 --- [RMI TCP Connection(5)-172.27.30.1] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 14:27:54.069  INFO 1216 --- [http-nio-8080-exec-1] c.l.m.p.c.s.i.ProductCommandServiceImpl  : Send create product command: ProductDto(price=10.5, quantity=100)
2022-09-06 14:27:54.071 TRACE 1216 --- [http-nio-8080-exec-1] .m.p.c.i.DeleteProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='b5e02bec-e38b-4603-814e-25ab5d0afd03', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 14:27:54.072  INFO 1216 --- [http-nio-8080-exec-1] .m.p.c.i.DeleteProductCommandInterceptor : Pass to next dispatch interceptor
2022-09-06 14:27:54.072 TRACE 1216 --- [http-nio-8080-exec-1] .m.p.c.i.CreateProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='b5e02bec-e38b-4603-814e-25ab5d0afd03', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 14:27:54.073  INFO 1216 --- [http-nio-8080-exec-1] .m.p.c.i.CreateProductCommandInterceptor : Create product command interceptor handle
2022-09-06 14:27:54.084  INFO 1216 --- [http-nio-8080-exec-1] .m.p.c.i.CreateProductCommandInterceptor : Product creation is valid
2022-09-06 14:27:54.084 TRACE 1216 --- [http-nio-8080-exec-1] .m.p.c.i.UpdateProductCommandInterceptor : Interceptor command message: GenericCommandMessage{payload={CreateProductCommand(price=10.5, quantity=100)}, metadata={}, messageIdentifier='b5e02bec-e38b-4603-814e-25ab5d0afd03', commandName='com.liem.ms.productservice.command.commands.product.CreateProductCommand'}
2022-09-06 14:27:54.085  INFO 1216 --- [http-nio-8080-exec-1] .m.p.c.i.UpdateProductCommandInterceptor : Pass to next dispatch interceptor
2022-09-06 14:27:54.106 TRACE 1216 --- [CommandProcessor-3] c.l.m.p.core.domain.ProductAggregate     : Create product command handle: CreateProductCommand(price=10.5, quantity=100)
2022-09-06 14:27:54.109 TRACE 1216 --- [CommandProcessor-3] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:27:54.116 TRACE 1216 --- [CommandProcessor-3] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:27:54.116  INFO 1216 --- [CommandProcessor-3] .m.p.c.h.i.ProductLookupEventHandlerImpl : Save look up entity: ProductLookupEntity(productId=b4f04a10-7630-465b-8729-6345f689777a, productName=Product_003, productQuantity=100)
2022-09-06 14:27:54.136 TRACE 1216 --- [CommandProcessor-3] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:27:54.137  INFO 1216 --- [CommandProcessor-3] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Create entity: ProductEntity(id=b4f04a10-7630-465b-8729-6345f689777a, name=Product_003, description=Product_003, updatedAt=2022-09-06T07:27:54.136950400Z, createdAt=2022-09-06T07:27:54.137951200Z, version=1, isActive=true, price=10.5, quantity=100)
2022-09-06 14:28:25.887  INFO 10468 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Send create order command: OrderDto(id=null, userId=user_001, productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, addressId=address_001, rejectReason=null, status=null)
2022-09-06 14:28:25.941 TRACE 10468 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Create order command handle: CreateOrderCommand(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, userId=user_001, productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:28:25.962 TRACE 10468 --- [CommandProcessor-0] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:28:25.989 TRACE 10468 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderCreatedEvent(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:28:25.990  INFO 10468 --- [CommandProcessor-0] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Create order: OrderEntity(id=2cffcdfc-eae8-4369-901b-85635e1e0bc4, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=300, addressId=address_001, rejectReason=null, orderStatus=CREATED)
2022-09-06 14:28:26.051 TRACE 10468 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:28:26.051  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=2cffcdfc-eae8-4369-901b-85635e1e0bc4, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=300)
2022-09-06 14:28:26.079  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Start transaction : handle after created order: OrderCreatedEvent(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:28:26.117 TRACE 1216 --- [CommandProcessor-4] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:28:26.119 TRACE 1216 --- [CommandProcessor-4] c.l.m.p.core.domain.ProductAggregate     : Reserve product command handle: ReserveProductCommand(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, userId=user_001)
2022-09-06 14:28:26.123 ERROR 1216 --- [CommandProcessor-4] c.l.m.p.core.domain.ProductAggregate     : Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items
2022-09-06 14:28:26.145 TRACE 10468 --- [grpc-default-executor-0] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command message: GenericCommandMessage{payload={ReserveProductCommand(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, userId=user_001)}, metadata={'traceId'->'61cc140c-182b-4a85-9d3a-9e1359aafe5c', 'correlationId'->'762d3bdd-bf28-4a8b-9fc9-d97efdca42c6'}, messageIdentifier='4e80a663-b19d-484e-a972-2c7f7c6b010e', commandName='com.liem.ms.coreservice.commands.ReserveProductCommand'}
2022-09-06 14:28:26.155 TRACE 10468 --- [grpc-default-executor-0] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'61cc140c-182b-4a85-9d3a-9e1359aafe5c', 'correlationId'->'4e80a663-b19d-484e-a972-2c7f7c6b010e'}, messageIdentifier='273e660a-e823-4754-9efa-8e53a42b607b', exception='org.axonframework.commandhandling.CommandExecutionException: Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items'}
2022-09-06 14:28:26.155 ERROR 10468 --- [grpc-default-executor-0] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Reserved product failed: Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items
2022-09-06 14:28:26.196 TRACE 1216 --- [CommandProcessor-5] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:28:26.198 TRACE 1216 --- [CommandProcessor-5] c.l.m.p.core.domain.ProductAggregate     : Cancel product reserve command handle: CancelProductReserveCommand(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, userId=user_001, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:28:26.199 TRACE 1216 --- [CommandProcessor-5] c.l.m.p.core.domain.ProductAggregate     : Product cancel reserve event sourcing handle: ProductCancelReserveEvent(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, userId=user_001, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:28:26.201 TRACE 1216 --- [CommandProcessor-5] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductCancelReserveEvent(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, userId=user_001, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:28:26.204  INFO 1216 --- [CommandProcessor-5] .m.p.c.h.i.ProductLookupEventHandlerImpl : Cancel reservation look up entity: ProductLookupEntity(productId=b4f04a10-7630-465b-8729-6345f689777a, productName=Product_003, productQuantity=400)
2022-09-06 14:28:26.231  INFO 10468 --- [grpc-default-executor-0] .s.i.CancelProductReservationServiceImpl : Cancel product 'b4f04a10-7630-465b-8729-6345f689777a' reservation completed
2022-09-06 14:28:26.253  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after cancel product reservation process: ProductCancelReserveEvent(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, userId=user_001, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:28:26.313 TRACE 10468 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=300, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:28:26.317 TRACE 10468 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Reject order command handle: RejectOrderCommand(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:28:26.318 TRACE 10468 --- [CommandProcessor-1] c.l.m.o.core.domain.OrderAggregate       : Order reject event sourcing handle: OrderRejectedEvent(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, orderStatus=REJECTED, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:28:26.328 TRACE 10468 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderRejectedEvent(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, orderStatus=REJECTED, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:28:26.334  INFO 10468 --- [CommandProcessor-1] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Reject order: OrderEntity(id=2cffcdfc-eae8-4369-901b-85635e1e0bc4, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=300, addressId=address_001, rejectReason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items, orderStatus=REJECTED)
2022-09-06 14:28:26.351 TRACE 10468 --- [grpc-default-executor-2] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Command message: GenericCommandMessage{payload={RejectOrderCommand(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)}, metadata={'traceId'->'58a7962f-2ff6-4a07-9ab2-3418d42bf345', 'correlationId'->'fc3eaf2e-c1c7-4bec-a741-0c16ea5190d9'}, messageIdentifier='d6533409-7d54-4c67-83b1-ba4e8a8d8b93', commandName='com.liem.ms.orderservice.command.commands.RejectOrderCommand'}
2022-09-06 14:28:26.352 TRACE 10468 --- [grpc-default-executor-2] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'58a7962f-2ff6-4a07-9ab2-3418d42bf345', 'correlationId'->'d6533409-7d54-4c67-83b1-ba4e8a8d8b93'}, messageIdentifier='30fe7581-ed6f-444b-b11a-4fe5924d98cc', exception='null'}
2022-09-06 14:28:26.352  INFO 10468 --- [grpc-default-executor-2] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Reject order completed
2022-09-06 14:28:26.367  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Complete transaction : handle after reject order: OrderRejectedEvent(orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, orderStatus=REJECTED, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:28:26.400  INFO 10468 --- [http-nio-8081-exec-1] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Query subscription close
2022-09-06 14:28:31.393  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:28:37.944  INFO 13216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:28:50.436  INFO 13216 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662449330436, current=DOWN, previous=UP]
2022-09-06 14:28:50.440  INFO 13216 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PAYMENT-SERVICE/payment-service:75b82d8c3dca1f89d2612a5952b25fdc: registering service...
2022-09-06 14:28:50.465  INFO 13216 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PAYMENT-SERVICE/payment-service:75b82d8c3dca1f89d2612a5952b25fdc - registration status: 204
2022-09-06 14:28:50.889  INFO 13216 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.paymentservice.query.handler'.
2022-09-06 14:28:50.891  INFO 13216 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.paymentservice.query.handler' awaiting termination...
2022-09-06 14:28:51.228  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 14:28:51.231  INFO 13216 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 14:28:51.287  INFO 13216 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.coreservice.commands.CancelPaymentCommand' in context 'default'
2022-09-06 14:28:51.290  INFO 13216 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.coreservice.commands.ProcessPaymentCommand' in context 'default'
2022-09-06 14:28:51.889  INFO 13216 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-09-06 14:28:51.901  INFO 13216 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-09-06 14:28:51.905  INFO 13216 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2022-09-06 14:28:54.907  INFO 13216 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2022-09-06 14:28:54.918  INFO 13216 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PAYMENT-SERVICE/payment-service:75b82d8c3dca1f89d2612a5952b25fdc - deregister  status: 200
2022-09-06 14:28:54.931  INFO 13216 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
2022-09-06 14:30:35.221  INFO 10468 --- [http-nio-8081-exec-2] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Send create order command: OrderDto(id=null, userId=user_001, productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, addressId=address_001, rejectReason=null, status=null)
2022-09-06 14:30:35.230 TRACE 10468 --- [CommandProcessor-2] c.l.m.o.core.domain.OrderAggregate       : Create order command handle: CreateOrderCommand(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001, productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:30:35.231 TRACE 10468 --- [CommandProcessor-2] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:30:35.235 TRACE 10468 --- [CommandProcessor-2] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderCreatedEvent(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:30:35.235  INFO 10468 --- [CommandProcessor-2] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Create order: OrderEntity(id=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=1, addressId=address_001, rejectReason=null, orderStatus=CREATED)
2022-09-06 14:30:35.258 TRACE 10468 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Order lookup handle: OrderCreatedEvent(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:30:35.258  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] c.l.m.o.c.h.OrderLookupEventHandler      : Create lookup order: OrderLookupEntity(id=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=1)
2022-09-06 14:30:35.259  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Start transaction : handle after created order: OrderCreatedEvent(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:30:35.289 TRACE 1216 --- [CommandProcessor-6] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:30:35.290 TRACE 1216 --- [CommandProcessor-6] c.l.m.p.core.domain.ProductAggregate     : Product cancel reserve event sourcing handle: ProductCancelReserveEvent(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, userId=user_001, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:30:35.290 TRACE 1216 --- [CommandProcessor-6] c.l.m.p.core.domain.ProductAggregate     : Reserve product command handle: ReserveProductCommand(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001)
2022-09-06 14:30:35.295  INFO 1216 --- [CommandProcessor-6] c.l.m.p.core.domain.ProductAggregate     : Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 1 items
2022-09-06 14:30:35.296 TRACE 1216 --- [CommandProcessor-6] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001)
2022-09-06 14:30:35.297 TRACE 1216 --- [CommandProcessor-6] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductReservedEvent(id=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001)
2022-09-06 14:30:35.300  INFO 1216 --- [CommandProcessor-6] .m.p.c.h.i.ProductLookupEventHandlerImpl : Reserve look up entity: ProductLookupEntity(productId=b4f04a10-7630-465b-8729-6345f689777a, productName=Product_003, productQuantity=399)
2022-09-06 14:30:35.301 TRACE 1216 --- [CommandProcessor-6] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Product handle: ProductReservedEvent(id=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001)
2022-09-06 14:30:35.304  INFO 1216 --- [CommandProcessor-6] c.l.m.p.q.h.i.ProductEventHandlerImpl    : Reserve product quantity: ProductEntity(id=b4f04a10-7630-465b-8729-6345f689777a, name=Product_003, description=Product_003, updatedAt=2022-09-06T14:30:35.304321700, createdAt=2022-09-06T07:27:54.137951200Z, version=2, isActive=true, price=10.5, quantity=99)
2022-09-06 14:30:35.331 TRACE 10468 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command message: GenericCommandMessage{payload={ReserveProductCommand(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001)}, metadata={'traceId'->'62bc57d3-eb0c-4a8e-9930-dc440945c23f', 'correlationId'->'ad154b5f-d063-43d1-b570-b9386d929cbd'}, messageIdentifier='6a51b40d-e105-4b90-8a60-b86141ae24ec', commandName='com.liem.ms.coreservice.commands.ReserveProductCommand'}
2022-09-06 14:30:35.331 TRACE 10468 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'62bc57d3-eb0c-4a8e-9930-dc440945c23f', 'correlationId'->'6a51b40d-e105-4b90-8a60-b86141ae24ec'}, messageIdentifier='265aefcc-7626-446e-9980-f559521aea50', exception='null'}
2022-09-06 14:30:35.331  INFO 10468 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ReserveProductServiceImpl  : Reserved product 'b4f04a10-7630-465b-8729-6345f689777a' with reserved quantity 1 items
2022-09-06 14:30:35.336  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after reserve product: ProductReservedEvent(id=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001)
2022-09-06 14:30:35.339  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send user payment details query: FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 14:30:35.356  INFO 23664 --- [QueryProcessor-5] c.l.m.u.query.handler.UserEventsHandler  : Find user payment detail query handle; FetchUserPaymentDetailsQuery(userId=user_001)
2022-09-06 14:30:35.373  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : User payment details query: User(firstName=Liem, lastName=Doan, userId=user_001, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123))
2022-09-06 14:30:35.386  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Schedule deadline for 'payment-process-deadline' by id '7d7f152b-8143-4980-be05-ba1b94bedbf4'
2022-09-06 14:30:35.387  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Send payment process command: ProcessPaymentCommand(paymentId=06284ae6-34ec-4447-a88c-88681abc12f1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, paymentDetails=PaymentDetails(name=Liem Doan, cardNumber=123Card, validUntilMonth=12, validUntilYear=2030, cvv=123), scheduleId=7d7f152b-8143-4980-be05-ba1b94bedbf4)
2022-09-06 14:30:35.401 ERROR 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand
2022-09-06 14:30:35.430 TRACE 1216 --- [CommandProcessor-7] c.l.m.p.core.domain.ProductAggregate     : Product created event sourcing handle: ProductCreatedEvent(price=10.5, quantity=100)
2022-09-06 14:30:35.431 TRACE 1216 --- [CommandProcessor-7] c.l.m.p.core.domain.ProductAggregate     : Product cancel reserve event sourcing handle: ProductCancelReserveEvent(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=300, orderId=2cffcdfc-eae8-4369-901b-85635e1e0bc4, userId=user_001, reason=Product 'b4f04a10-7630-465b-8729-6345f689777a' is insufficient by reserved quantity 300 items)
2022-09-06 14:30:35.433 TRACE 1216 --- [CommandProcessor-7] c.l.m.p.core.domain.ProductAggregate     : Product reserved event sourcing handle: ProductReservedEvent(id=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001)
2022-09-06 14:30:35.434 TRACE 1216 --- [CommandProcessor-7] c.l.m.p.core.domain.ProductAggregate     : Cancel product reserve command handle: CancelProductReserveCommand(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)
2022-09-06 14:30:35.434 TRACE 1216 --- [CommandProcessor-7] c.l.m.p.core.domain.ProductAggregate     : Product cancel reserve event sourcing handle: ProductCancelReserveEvent(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)
2022-09-06 14:30:35.437 TRACE 1216 --- [CommandProcessor-7] .m.p.c.h.i.ProductLookupEventHandlerImpl : Product lookup handle: ProductCancelReserveEvent(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)
2022-09-06 14:30:35.441  INFO 1216 --- [CommandProcessor-7] .m.p.c.h.i.ProductLookupEventHandlerImpl : Cancel reservation look up entity: ProductLookupEntity(productId=b4f04a10-7630-465b-8729-6345f689777a, productName=Product_003, productQuantity=400)
2022-09-06 14:30:35.467 TRACE 10468 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Command message: GenericCommandMessage{payload={CancelProductReserveCommand(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)}, metadata={'traceId'->'62bc57d3-eb0c-4a8e-9930-dc440945c23f', 'correlationId'->'1ff068fa-3c12-4a54-b3f9-f0e58a1b1994'}, messageIdentifier='f26bd465-3618-4100-8f87-0472cc75ba06', commandName='com.liem.ms.coreservice.commands.CancelProductReserveCommand'}
2022-09-06 14:30:35.468 TRACE 10468 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'62bc57d3-eb0c-4a8e-9930-dc440945c23f', 'correlationId'->'f26bd465-3618-4100-8f87-0472cc75ba06'}, messageIdentifier='0383de88-5e80-436f-b4fb-b4f1d4583a1f', exception='null'}
2022-09-06 14:30:35.469  INFO 10468 --- [grpc-default-executor-5] c.l.m.o.s.s.i.ProcessPaymentServiceImpl  : Reserved product reservation completed
2022-09-06 14:30:35.485  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Handle after cancel product reservation process: ProductCancelReserveEvent(productId=b4f04a10-7630-465b-8729-6345f689777a, quantity=1, orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, userId=user_001, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)
2022-09-06 14:30:35.512 TRACE 10468 --- [CommandProcessor-3] c.l.m.o.core.domain.OrderAggregate       : Order created event sourcing handle: OrderCreatedEvent(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=1, addressId=address_001, orderStatus=CREATED)
2022-09-06 14:30:35.516 TRACE 10468 --- [CommandProcessor-3] c.l.m.o.core.domain.OrderAggregate       : Reject order command handle: RejectOrderCommand(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)
2022-09-06 14:30:35.516 TRACE 10468 --- [CommandProcessor-3] c.l.m.o.core.domain.OrderAggregate       : Order reject event sourcing handle: OrderRejectedEvent(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, orderStatus=REJECTED, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)
2022-09-06 14:30:35.519 TRACE 10468 --- [CommandProcessor-3] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Order handle: OrderRejectedEvent(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, orderStatus=REJECTED, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)
2022-09-06 14:30:35.523  INFO 10468 --- [CommandProcessor-3] c.l.m.o.q.h.impl.OrderEventsHandlerImpl  : Reject order: OrderEntity(id=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, productId=b4f04a10-7630-465b-8729-6345f689777a, userId=user_001, quantity=1, addressId=address_001, rejectReason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand, orderStatus=REJECTED)
2022-09-06 14:30:35.539 TRACE 10468 --- [grpc-default-executor-5] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Command message: GenericCommandMessage{payload={RejectOrderCommand(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)}, metadata={'traceId'->'62bc57d3-eb0c-4a8e-9930-dc440945c23f', 'correlationId'->'a4fee79b-7950-4a92-ab19-2580dddc042f'}, messageIdentifier='56068573-a72c-48d7-9a94-3e17c15776bc', commandName='com.liem.ms.orderservice.command.commands.RejectOrderCommand'}
2022-09-06 14:30:35.540 TRACE 10468 --- [grpc-default-executor-5] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Command result message: GenericCommandResultMessage{payload={null}, metadata={'traceId'->'62bc57d3-eb0c-4a8e-9930-dc440945c23f', 'correlationId'->'56068573-a72c-48d7-9a94-3e17c15776bc'}, messageIdentifier='eb5384f2-dc20-4834-bd6c-323fd9bb7c81', exception='null'}
2022-09-06 14:30:35.540  INFO 10468 --- [grpc-default-executor-5] c.l.m.o.s.s.impl.RejectOrderServiceImpl  : Reject order completed
2022-09-06 14:30:35.554  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] c.l.m.o.saga.saga.impl.OrderSagaImpl     : Complete transaction : handle after reject order: OrderRejectedEvent(orderId=ed4d61df-f160-4cc7-a7a9-78bdb9c86a13, orderStatus=REJECTED, reason=Payment process failed: No Handler for command: com.liem.ms.coreservice.commands.ProcessPaymentCommand)
2022-09-06 14:30:35.567  INFO 10468 --- [http-nio-8081-exec-2] c.l.m.o.c.s.i.OrderCommandServiceImpl    : Query subscription close
2022-09-06 14:31:53.063  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:32:41.739  INFO 10468 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:33:31.394  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:36:53.064  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:37:41.741  INFO 10468 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:38:31.396  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:41:53.065  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:42:41.743  INFO 10468 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:43:07.808  INFO 16888 --- [restartedMain] c.l.m.p.PaymentServiceApplication        : Starting PaymentServiceApplication using Java 11.0.12 on DESKTOP-6L79JE3 with PID 16888 (D:\Work\event-driven-ms\payment-service\target\classes started by Liem in D:\Work\event-driven-ms)
2022-09-06 14:43:07.809 DEBUG 16888 --- [restartedMain] c.l.m.p.PaymentServiceApplication        : Running with Spring Boot v2.7.3, Spring v5.3.22
2022-09-06 14:43:07.810  INFO 16888 --- [restartedMain] c.l.m.p.PaymentServiceApplication        : The following 1 profile is active: "dev"
2022-09-06 14:43:11.354  INFO 16888 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-09-06 14:43:11.355  INFO 16888 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.65]
2022-09-06 14:43:11.529  INFO 16888 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring embedded WebApplicationContext
2022-09-06 14:43:12.294  INFO 16888 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-09-06 14:43:12.517  INFO 16888 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-09-06 14:43:12.758  INFO 16888 --- [restartedMain] liquibase.database                       : Set default schema name to public
2022-09-06 14:43:12.898  INFO 16888 --- [restartedMain] liquibase.lockservice                    : Successfully acquired change log lock
2022-09-06 14:43:13.553  INFO 16888 --- [restartedMain] liquibase.changelog                      : Reading from public.databasechangelog
2022-09-06 14:43:13.635  INFO 16888 --- [restartedMain] liquibase.lockservice                    : Successfully released change log lock
2022-09-06 14:43:13.760  INFO 16888 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-09-06 14:43:13.836  INFO 16888 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.10.Final
2022-09-06 14:43:14.066  INFO 16888 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-09-06 14:43:14.215  INFO 16888 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.PostgreSQL10Dialect
2022-09-06 14:43:15.124  INFO 16888 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-09-06 14:43:17.006  INFO 16888 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.Dom4JToByteArrayConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 14:43:17.008  INFO 16888 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToDom4jConverter] is ignored. It seems to rely on a class that is not available in the class loader: org/dom4j/Document
2022-09-06 14:43:17.009  INFO 16888 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.XomToStringConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 14:43:17.010  INFO 16888 --- [restartedMain] o.a.serialization.ChainingConverter      : ContentTypeConverter of type [class org.axonframework.serialization.xml.InputStreamToXomConverter] is ignored. It seems to rely on a class that is not available in the class loader: nu/xom/Document
2022-09-06 14:43:20.159  INFO 16888 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Requesting connection details from localhost:8124
2022-09-06 14:43:20.903  INFO 16888 --- [restartedMain] i.a.a.c.impl.AxonServerManagedChannel    : Successfully connected to localhost:8124
2022-09-06 14:43:20.921  INFO 16888 --- [restartedMain] i.a.a.connector.impl.ControlChannelImpl  : Connected instruction stream for context 'default'. Sending client identification
2022-09-06 14:43:20.938  INFO 16888 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : CommandChannel for context 'default' connected, 0 command handlers registered
2022-09-06 14:43:20.940  INFO 16888 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.CancelPaymentCommand' in context 'default'
2022-09-06 14:43:20.951  INFO 16888 --- [restartedMain] i.a.a.c.command.impl.CommandChannelImpl  : Registered handler for command 'com.liem.ms.coreservice.commands.ProcessPaymentCommand' in context 'default'
2022-09-06 14:43:21.139  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1
2022-09-06 14:43:21.140  INFO 16888 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] o.a.e.TrackingEventProcessor             : Worker assigned to segment Segment[0/0] for processing
2022-09-06 14:43:21.145  INFO 16888 --- [restartedMain] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:43:21.147  INFO 16888 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] o.a.e.TrackingEventProcessor             : Using current Thread for last segment worker: TrackingSegmentWorker{processor=com.liem.ms.paymentservice.query.handler, segment=Segment[0/0]}
2022-09-06 14:43:21.171  INFO 16888 --- [EventProcessor[com.liem.ms.paymentservice.query.handler]-0] o.a.e.TrackingEventProcessor             : Fetched token: IndexTrackingToken{globalIndex=68} for segment: Segment[0/0]
2022-09-06 14:43:21.176  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Disable delta property : false
2022-09-06 14:43:21.177  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null
2022-09-06 14:43:21.177  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false
2022-09-06 14:43:21.177  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application is null : false
2022-09-06 14:43:21.177  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true
2022-09-06 14:43:21.178  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Application version is -1: true
2022-09-06 14:43:21.178  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server
2022-09-06 14:43:21.624  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : The response status is 200
2022-09-06 14:43:21.628  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30
2022-09-06 14:43:21.632  INFO 16888 --- [restartedMain] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4
2022-09-06 14:43:21.638  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1662450201637 with initial instances count: 3
2022-09-06 14:43:21.647  INFO 16888 --- [restartedMain] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662450201647, current=UP, previous=STARTING]
2022-09-06 14:43:21.650  INFO 16888 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PAYMENT-SERVICE/payment-service:5c42492a39cbeac0425348f7328486b1: registering service...
2022-09-06 14:43:21.700  INFO 16888 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_PAYMENT-SERVICE/payment-service:5c42492a39cbeac0425348f7328486b1 - registration status: 204
2022-09-06 14:43:22.012  INFO 16888 --- [restartedMain] c.l.m.p.PaymentServiceApplication        : Started PaymentServiceApplication in 15.277 seconds (JVM running for 17.12)
2022-09-06 14:43:22.531  INFO 16888 --- [RMI TCP Connection(3)-172.27.30.1] o.a.c.c.C.[Tomcat].[localhost].[/order]  : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-09-06 14:43:31.399  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:46:53.067  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:47:41.746  INFO 10468 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:48:21.181  INFO 16888 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:48:31.400  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:51:53.068  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:52:41.747  INFO 10468 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:53:21.183  INFO 16888 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:53:31.401  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:56:53.070  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:57:41.750  INFO 10468 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:58:21.186  INFO 16888 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 14:58:31.402  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 15:01:53.073  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 15:02:41.752  INFO 10468 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 15:03:21.187  INFO 16888 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 15:03:31.403  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 15:04:21.484 ERROR 10468 --- [http-nio-8081-exec-3] o.a.c.c.C.[.[.[.[dispatcherServlet]      : Servlet.service() for servlet [dispatcherServlet] in context with path [/order] threw exception [Request processing failed; nested exception is java.util.concurrent.CompletionException: org.axonframework.queryhandling.QueryExecutionException: No handler found for [com.liem.ms.orderservice.query.queries.FindOrderQuery] with response type [InstanceResponseType{class com.liem.ms.orderservice.core.dto.OrderDto}]] with root cause

org.axonframework.axonserver.connector.query.AxonServerRemoteQueryHandlingException: An exception was thrown by the remote message handling component: No handler found for [com.liem.ms.orderservice.query.queries.FindOrderQuery] with response type [InstanceResponseType{class com.liem.ms.orderservice.core.dto.OrderDto}]
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$15(ErrorCode.java:107) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:182) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at org.axonframework.axonserver.connector.query.GrpcBackedResponseMessage.<init>(GrpcBackedResponseMessage.java:64) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at org.axonframework.axonserver.connector.query.QuerySerializer.deserializeResponse(QuerySerializer.java:176) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at org.axonframework.axonserver.connector.query.AxonServerQueryBus$ResponseProcessingTask.run(AxonServerQueryBus.java:761) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:829) ~[na:na]

2022-09-06 15:04:34.027 ERROR 10468 --- [http-nio-8081-exec-4] o.a.c.c.C.[.[.[.[dispatcherServlet]      : Servlet.service() for servlet [dispatcherServlet] in context with path [/order] threw exception [Request processing failed; nested exception is java.util.concurrent.CompletionException: org.axonframework.queryhandling.QueryExecutionException: No handler found for [com.liem.ms.orderservice.query.queries.FindOrderQuery] with response type [InstanceResponseType{class com.liem.ms.orderservice.core.dto.OrderDto}]] with root cause

org.axonframework.axonserver.connector.query.AxonServerRemoteQueryHandlingException: An exception was thrown by the remote message handling component: No handler found for [com.liem.ms.orderservice.query.queries.FindOrderQuery] with response type [InstanceResponseType{class com.liem.ms.orderservice.core.dto.OrderDto}]
	at org.axonframework.axonserver.connector.ErrorCode.lambda$static$15(ErrorCode.java:107) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at org.axonframework.axonserver.connector.ErrorCode.convert(ErrorCode.java:182) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at org.axonframework.axonserver.connector.query.GrpcBackedResponseMessage.<init>(GrpcBackedResponseMessage.java:64) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at org.axonframework.axonserver.connector.query.QuerySerializer.deserializeResponse(QuerySerializer.java:176) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at org.axonframework.axonserver.connector.query.AxonServerQueryBus$ResponseProcessingTask.run(AxonServerQueryBus.java:761) ~[axon-server-connector-4.5.15.jar:4.5.15]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:829) ~[na:na]

2022-09-06 15:06:53.074  INFO 1216 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 15:07:41.753  INFO 10468 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 15:08:21.188  INFO 16888 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 15:08:31.404  INFO 23664 --- [AsyncResolver-bootstrap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration
2022-09-06 15:08:40.074  INFO 10468 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1662451720074, current=DOWN, previous=UP]
2022-09-06 15:08:40.075  INFO 10468 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:61d5a1b1c9a7dfc71d15a308bec0e528: registering service...
2022-09-06 15:08:40.088  INFO 10468 --- [DiscoveryClient-InstanceInfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:61d5a1b1c9a7dfc71d15a308bec0e528 - registration status: 204
2022-09-06 15:08:40.311  INFO 10468 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'OrderSagaImplProcessor'.
2022-09-06 15:08:40.312  INFO 10468 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'OrderSagaImplProcessor' awaiting termination...
2022-09-06 15:08:40.320  INFO 10468 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.command.handler'.
2022-09-06 15:08:40.321  INFO 10468 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.command.handler' awaiting termination...
2022-09-06 15:08:40.322  INFO 10468 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Shutdown state set for Processor 'com.liem.ms.orderservice.saga.handler.impl'.
2022-09-06 15:08:40.322  INFO 10468 --- [SpringApplicationShutdownHook] o.a.e.TrackingEventProcessor             : Processor 'com.liem.ms.orderservice.saga.handler.impl' awaiting termination...
2022-09-06 15:08:41.015  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 15:08:41.016  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 15:08:41.016  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Released claim
2022-09-06 15:08:41.016  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.saga.handler.impl]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 15:08:41.017  INFO 10468 --- [EventProcessor[com.liem.ms.orderservice.command.handler]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 15:08:41.017  INFO 10468 --- [EventProcessor[OrderSagaImplProcessor]-0] o.a.e.TrackingEventProcessor             : Worker for segment Segment[0/0] stopped.
2022-09-06 15:08:41.026  INFO 10468 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.ApproveOrderCommand' in context 'default'
2022-09-06 15:08:41.027  INFO 10468 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.CreateOrderCommand' in context 'default'
2022-09-06 15:08:41.027  INFO 10468 --- [SpringApplicationShutdownHook] i.a.a.c.command.impl.CommandChannelImpl  : Unregistered handler for command 'com.liem.ms.orderservice.command.commands.RejectOrderCommand' in context 'default'
2022-09-06 15:08:41.429  INFO 10468 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2022-09-06 15:08:41.438  INFO 10468 --- [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2022-09-06 15:08:41.440  INFO 10468 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Shutting down DiscoveryClient ...
2022-09-06 15:08:44.444  WARN 10468 --- [DiscoveryClient-0] c.netflix.discovery.TimedSupervisorTask  : task supervisor shutting down, can't accept the task
2022-09-06 15:08:44.444  INFO 10468 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Unregistering ...
2022-09-06 15:08:44.449  INFO 10468 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_ORDER-SERVICE/order-service:61d5a1b1c9a7dfc71d15a308bec0e528 - deregister  status: 200
2022-09-06 15:08:44.454  INFO 10468 --- [SpringApplicationShutdownHook] com.netflix.discovery.DiscoveryClient    : Completed shut down of DiscoveryClient
